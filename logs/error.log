{"ts": "2025-08-20T15:43:45", "level": "ERROR", "logger": "app", "msg": "UNHANDLED EXCEPTION", "request_id": "f354496c01404fbd8192a40a2f7ff9f2", "exc": "Traceback (most recent call last):\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\flask\\app.py\", line 917, in full_dispatch_request\n    rv = self.dispatch_request()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\flask\\app.py\", line 902, in dispatch_request\n    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]\n  File \"D:\\TestTrackingSystem\\controllers\\auth_helpers.py\", line 161, in wrapper\n    return fn(*args, **kwargs)\n  File \"D:\\TestTrackingSystem\\controllers\\auth_controller.py\", line 82, in change_password\n    result = PasswordService.change_password(\nTypeError: PasswordService.change_password() got an unexpected keyword argument 'username'"}
{"ts": "2025-08-20T17:02:28", "level": "ERROR", "logger": "app", "msg": "UNHANDLED EXCEPTION", "request_id": "6686fa29be7b4324848c6c6645e2a204", "exc": "Traceback (most recent call last):\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\flask\\app.py\", line 917, in full_dispatch_request\n    rv = self.dispatch_request()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\flask\\app.py\", line 902, in dispatch_request\n    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]\n  File \"D:\\TestTrackingSystem\\controllers\\auth_controller.py\", line 20, in login\n    user = UserService.authenticate(username, password)\n  File \"D:\\TestTrackingSystem\\services\\user_service.py\", line 62, in authenticate\n    print(user.password_hash)\nAttributeError: 'NoneType' object has no attribute 'password_hash'"}
{"ts": "2025-08-21T17:32:33", "level": "ERROR", "logger": "app", "msg": "UNHANDLED EXCEPTION", "request_id": "0d170d2bb6744dd1bc8c23d62b031462", "exc": "Traceback (most recent call last):\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 806, in _write_bytes\n    self._sock.sendall(data)\nConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 951, in do_execute\n    cursor.execute(statement, parameters)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\cursors.py\", line 153, in execute\n    result = self._query(query)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\cursors.py\", line 322, in _query\n    conn.query(q)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 562, in query\n    self._execute_command(COMMAND.COM_QUERY, sql)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 864, in _execute_command\n    self._write_bytes(packet)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 809, in _write_bytes\n    raise err.OperationalError(\npymysql.err.OperationalError: (2006, \"MySQL server has gone away (ConnectionResetError(10054, '远程主机强迫关闭了一个现有的连接。', None, 10054, None))\")\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\flask\\app.py\", line 917, in full_dispatch_request\n    rv = self.dispatch_request()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\flask\\app.py\", line 902, in dispatch_request\n    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]\n  File \"D:\\TestTrackingSystem\\controllers\\auth_helpers.py\", line 123, in wrapper\n    user = _resolve_user_from_token(token)\n  File \"D:\\TestTrackingSystem\\controllers\\auth_helpers.py\", line 37, in _resolve_user_from_token\n    user = UserRepository.find_by_id(user_id)\n  File \"D:\\TestTrackingSystem\\repositories\\user_repository.py\", line 26, in find_by_id\n    return User.query.get(user_id)\n  File \"<string>\", line 2, in get\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\util\\deprecations.py\", line 386, in warned\n    return fn(*args, **kwargs)  # type: ignore[no-any-return]\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\query.py\", line 1126, in get\n    return self._get_impl(ident, loading.load_on_pk_identity)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\query.py\", line 1135, in _get_impl\n    return self.session._get_impl(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 3873, in _get_impl\n    return db_load_fn(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\loading.py\", line 695, in load_on_pk_identity\n    session.execute(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2365, in execute\n    return self._execute_internal(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2251, in _execute_internal\n    result: Result[Any] = compile_state_cls.orm_execute_statement(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\context.py\", line 306, in orm_execute_statement\n    result = conn.execute(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1419, in execute\n    return meth(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\sql\\elements.py\", line 526, in _execute_on_connection\n    return connection._execute_clauseelement(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1641, in _execute_clauseelement\n    ret = self._execute_context(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1846, in _execute_context\n    return self._exec_single_context(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1986, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2355, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 951, in do_execute\n    cursor.execute(statement, parameters)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\cursors.py\", line 153, in execute\n    result = self._query(query)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\cursors.py\", line 322, in _query\n    conn.query(q)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 562, in query\n    self._execute_command(COMMAND.COM_QUERY, sql)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 864, in _execute_command\n    self._write_bytes(packet)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 809, in _write_bytes\n    raise err.OperationalError(\nsqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2006, \"MySQL server has gone away (ConnectionResetError(10054, '远程主机强迫关闭了一个现有的连接。', None, 10054, None))\")\n[SQL: SELECT user.id AS user_id, user.username AS user_username, user.password_hash AS user_password_hash, user.email AS user_email, user.phone AS user_phone, user.`role` AS user_role, user.active AS user_active, user.password_version AS user_password_version, user.password_updated_at AS user_password_updated_at, user.created_at AS user_created_at, user.updated_at AS user_updated_at \nFROM user \nWHERE user.id = %(pk_1)s]\n[parameters: {'pk_1': 1}]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)"}
{"ts": "2025-08-22T09:34:36", "level": "ERROR", "logger": "app", "msg": "UNHANDLED EXCEPTION", "request_id": "ce41d13fcd02454a85532c8dff520178", "exc": "Traceback (most recent call last):\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 806, in _write_bytes\n    self._sock.sendall(data)\nConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 951, in do_execute\n    cursor.execute(statement, parameters)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\cursors.py\", line 153, in execute\n    result = self._query(query)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\cursors.py\", line 322, in _query\n    conn.query(q)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 562, in query\n    self._execute_command(COMMAND.COM_QUERY, sql)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 864, in _execute_command\n    self._write_bytes(packet)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 809, in _write_bytes\n    raise err.OperationalError(\npymysql.err.OperationalError: (2006, \"MySQL server has gone away (ConnectionResetError(10054, '远程主机强迫关闭了一个现有的连接。', None, 10054, None))\")\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\flask\\app.py\", line 917, in full_dispatch_request\n    rv = self.dispatch_request()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\flask\\app.py\", line 902, in dispatch_request\n    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]\n  File \"D:\\TestTrackingSystem\\controllers\\auth_helpers.py\", line 123, in wrapper\n    user = _resolve_user_from_token(token)\n  File \"D:\\TestTrackingSystem\\controllers\\auth_helpers.py\", line 37, in _resolve_user_from_token\n    user = UserRepository.find_by_id(user_id)\n  File \"D:\\TestTrackingSystem\\repositories\\user_repository.py\", line 26, in find_by_id\n    return User.query.get(user_id)\n  File \"<string>\", line 2, in get\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\util\\deprecations.py\", line 386, in warned\n    return fn(*args, **kwargs)  # type: ignore[no-any-return]\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\query.py\", line 1126, in get\n    return self._get_impl(ident, loading.load_on_pk_identity)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\query.py\", line 1135, in _get_impl\n    return self.session._get_impl(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 3873, in _get_impl\n    return db_load_fn(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\loading.py\", line 695, in load_on_pk_identity\n    session.execute(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2365, in execute\n    return self._execute_internal(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2251, in _execute_internal\n    result: Result[Any] = compile_state_cls.orm_execute_statement(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\context.py\", line 306, in orm_execute_statement\n    result = conn.execute(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1419, in execute\n    return meth(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\sql\\elements.py\", line 526, in _execute_on_connection\n    return connection._execute_clauseelement(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1641, in _execute_clauseelement\n    ret = self._execute_context(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1846, in _execute_context\n    return self._exec_single_context(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1986, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2355, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 951, in do_execute\n    cursor.execute(statement, parameters)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\cursors.py\", line 153, in execute\n    result = self._query(query)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\cursors.py\", line 322, in _query\n    conn.query(q)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 562, in query\n    self._execute_command(COMMAND.COM_QUERY, sql)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 864, in _execute_command\n    self._write_bytes(packet)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 809, in _write_bytes\n    raise err.OperationalError(\nsqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2006, \"MySQL server has gone away (ConnectionResetError(10054, '远程主机强迫关闭了一个现有的连接。', None, 10054, None))\")\n[SQL: SELECT user.id AS user_id, user.username AS user_username, user.password_hash AS user_password_hash, user.email AS user_email, user.phone AS user_phone, user.`role` AS user_role, user.active AS user_active, user.password_version AS user_password_version, user.password_updated_at AS user_password_updated_at, user.created_at AS user_created_at, user.updated_at AS user_updated_at \nFROM user \nWHERE user.id = %(pk_1)s]\n[parameters: {'pk_1': 1}]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)"}
{"ts": "2025-08-22T10:13:34", "level": "ERROR", "logger": "app", "msg": "UNHANDLED EXCEPTION", "request_id": "62db4826da384fce9bcbecf505395b52", "exc": "Traceback (most recent call last):\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\flask\\app.py\", line 917, in full_dispatch_request\n    rv = self.dispatch_request()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\flask\\app.py\", line 902, in dispatch_request\n    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]\n  File \"D:\\TestTrackingSystem\\controllers\\auth_helpers.py\", line 133, in wrapper\n    return fn(*args, **kwargs)\n  File \"D:\\TestTrackingSystem\\controllers\\user_controller.py\", line 90, in list_users\n    items, total, dept_map = UserService.list_users(\n  File \"D:\\TestTrackingSystem\\services\\user_service.py\", line 154, in list_users\n    return UserRepository.list(\n  File \"D:\\TestTrackingSystem\\repositories\\user_repository.py\", line 125, in list\n    q = q.filter(and_(*conditions))\nNameError: name 'and_' is not defined"}
{"ts": "2025-08-22T10:16:03", "level": "ERROR", "logger": "app", "msg": "UNHANDLED EXCEPTION", "request_id": "968752898e8f438a977a03cd3ad8dace", "exc": "Traceback (most recent call last):\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\flask\\app.py\", line 917, in full_dispatch_request\n    rv = self.dispatch_request()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\flask\\app.py\", line 902, in dispatch_request\n    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]\n  File \"D:\\TestTrackingSystem\\controllers\\auth_helpers.py\", line 133, in wrapper\n    return fn(*args, **kwargs)\n  File \"D:\\TestTrackingSystem\\controllers\\user_controller.py\", line 90, in list_users\n    items, total, dept_map = UserService.list_users(\nTypeError: cannot unpack non-iterable NoneType object"}
{"ts": "2025-08-22T14:44:27", "level": "ERROR", "logger": "app", "msg": "UNHANDLED EXCEPTION", "request_id": "c897a7d122bf427a8126fbb89f0edf2e", "exc": "Traceback (most recent call last):\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\flask\\app.py\", line 917, in full_dispatch_request\n    rv = self.dispatch_request()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\flask\\app.py\", line 902, in dispatch_request\n    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]\n  File \"D:\\TestTrackingSystem\\controllers\\auth_helpers.py\", line 133, in wrapper\n    return fn(*args, **kwargs)\n  File \"D:\\TestTrackingSystem\\controllers\\department_controller.py\", line 159, in list_members\n    members, total = DepartmentMemberService.list_members(\n  File \"D:\\TestTrackingSystem\\services\\department_member_service.py\", line 61, in list_members\n    if not dept or dept.status == \"deleted\":\nAttributeError: 'Department' object has no attribute 'status'"}
{"ts": "2025-08-22T14:48:36", "level": "ERROR", "logger": "app", "msg": "UNHANDLED EXCEPTION", "request_id": "88b19b6953674ebe8bf4eed64e91a4ce", "exc": "Traceback (most recent call last):\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\flask\\app.py\", line 917, in full_dispatch_request\n    rv = self.dispatch_request()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\flask\\app.py\", line 902, in dispatch_request\n    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]\n  File \"D:\\TestTrackingSystem\\controllers\\auth_helpers.py\", line 133, in wrapper\n    return fn(*args, **kwargs)\n  File \"D:\\TestTrackingSystem\\controllers\\department_controller.py\", line 159, in list_members\n    members, total = DepartmentMemberService.list_members(\n  File \"D:\\TestTrackingSystem\\services\\department_member_service.py\", line 61, in list_members\n    if not dept or dept.status == \"deleted\":\nAttributeError: 'Department' object has no attribute 'status'"}
{"ts": "2025-08-22T15:43:59", "level": "ERROR", "logger": "app", "msg": "UNHANDLED EXCEPTION", "request_id": "60e87e9185f14a87bf9ebeef63dbafa6", "exc": "Traceback (most recent call last):\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\flask\\app.py\", line 917, in full_dispatch_request\n    rv = self.dispatch_request()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\flask\\app.py\", line 902, in dispatch_request\n    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]\n  File \"D:\\TestTrackingSystem\\controllers\\auth_helpers.py\", line 133, in wrapper\n    return fn(*args, **kwargs)\n  File \"D:\\TestTrackingSystem\\controllers\\department_controller.py\", line 92, in get_department\n    return json_response(data=dept.to_dict(with_counts=True, with_members=with_members))\nTypeError: Department.to_dict() got an unexpected keyword argument 'with_counts'"}
{"ts": "2025-08-22T15:44:17", "level": "ERROR", "logger": "app", "msg": "UNHANDLED EXCEPTION", "request_id": "135755fc647149cfa9874da5bb96d9ee", "exc": "Traceback (most recent call last):\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\flask\\app.py\", line 917, in full_dispatch_request\n    rv = self.dispatch_request()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\flask\\app.py\", line 902, in dispatch_request\n    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]\n  File \"D:\\TestTrackingSystem\\controllers\\auth_helpers.py\", line 133, in wrapper\n    return fn(*args, **kwargs)\n  File \"D:\\TestTrackingSystem\\controllers\\department_controller.py\", line 92, in get_department\n    return json_response(data=dept.to_dict(with_counts=True, with_members=with_members))\nTypeError: Department.to_dict() got an unexpected keyword argument 'with_counts'"}
{"ts": "2025-08-22T15:57:54", "level": "ERROR", "logger": "app", "msg": "UNHANDLED EXCEPTION", "request_id": "10a050aa55f9468d85d7fadd910ba24b", "exc": "Traceback (most recent call last):\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\flask\\app.py\", line 917, in full_dispatch_request\n    rv = self.dispatch_request()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\flask\\app.py\", line 902, in dispatch_request\n    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]\n  File \"D:\\TestTrackingSystem\\controllers\\auth_helpers.py\", line 133, in wrapper\n    return fn(*args, **kwargs)\n  File \"D:\\TestTrackingSystem\\controllers\\department_controller.py\", line 110, in update_department\n    return json_response(message=\"更新成功\", data=dept.to_dict(with_counts=True))\nTypeError: Department.to_dict() got an unexpected keyword argument 'with_counts'"}
{"ts": "2025-08-22T16:18:08", "level": "ERROR", "logger": "app", "msg": "UNHANDLED EXCEPTION", "request_id": "261133b15a244a3f80159b0887acb0b4", "exc": "Traceback (most recent call last):\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\flask\\app.py\", line 917, in full_dispatch_request\n    rv = self.dispatch_request()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\flask\\app.py\", line 902, in dispatch_request\n    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]\n  File \"D:\\TestTrackingSystem\\controllers\\auth_helpers.py\", line 133, in wrapper\n    return fn(*args, **kwargs)\n  File \"D:\\TestTrackingSystem\\controllers\\department_controller.py\", line 104, in update_department\n    active_raw = data.get(\"active\", \"\").strip()\nAttributeError: 'bool' object has no attribute 'strip'"}
{"ts": "2025-08-22T16:49:47", "level": "ERROR", "logger": "app", "msg": "UNHANDLED EXCEPTION", "request_id": "86aa2df5615a4d7e91123d874548f31c", "exc": "Traceback (most recent call last):\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\flask\\app.py\", line 917, in full_dispatch_request\n    rv = self.dispatch_request()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\flask\\app.py\", line 902, in dispatch_request\n    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]\n  File \"D:\\TestTrackingSystem\\controllers\\auth_helpers.py\", line 133, in wrapper\n    return fn(*args, **kwargs)\n  File \"D:\\TestTrackingSystem\\controllers\\department_controller.py\", line 30, in create_department\n    dept = DepartmentService.create(\n  File \"D:\\TestTrackingSystem\\services\\department_service.py\", line 27, in create\n    dept = DepartmentRepository.create(name=name, code=code, description=description, status=\"active\")\n  File \"D:\\TestTrackingSystem\\repositories\\department_repository.py\", line 19, in create\n    dept = Department(name=name.strip(), code=code.strip() if code else None,\n  File \"<string>\", line 4, in __init__\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\state.py\", line 571, in _initialize_instance\n    with util.safe_reraise():\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\util\\langhelpers.py\", line 224, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\state.py\", line 569, in _initialize_instance\n    manager.original_init(*mixed[1:], **kwargs)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\decl_base.py\", line 2179, in _declarative_constructor\n    raise TypeError(\nTypeError: 'status' is an invalid keyword argument for Department"}
{"ts": "2025-08-22T16:49:54", "level": "ERROR", "logger": "app", "msg": "UNHANDLED EXCEPTION", "request_id": "7b4351dba24a478a96f15f390c36cb9e", "exc": "Traceback (most recent call last):\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\flask\\app.py\", line 917, in full_dispatch_request\n    rv = self.dispatch_request()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\flask\\app.py\", line 902, in dispatch_request\n    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]\n  File \"D:\\TestTrackingSystem\\controllers\\auth_helpers.py\", line 133, in wrapper\n    return fn(*args, **kwargs)\n  File \"D:\\TestTrackingSystem\\controllers\\department_controller.py\", line 30, in create_department\n    dept = DepartmentService.create(\n  File \"D:\\TestTrackingSystem\\services\\department_service.py\", line 27, in create\n    dept = DepartmentRepository.create(name=name, code=code, description=description, status=\"active\")\n  File \"D:\\TestTrackingSystem\\repositories\\department_repository.py\", line 19, in create\n    dept = Department(name=name.strip(), code=code.strip() if code else None,\n  File \"<string>\", line 4, in __init__\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\state.py\", line 571, in _initialize_instance\n    with util.safe_reraise():\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\util\\langhelpers.py\", line 224, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\state.py\", line 569, in _initialize_instance\n    manager.original_init(*mixed[1:], **kwargs)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\decl_base.py\", line 2179, in _declarative_constructor\n    raise TypeError(\nTypeError: 'status' is an invalid keyword argument for Department"}
{"ts": "2025-08-22T16:51:03", "level": "ERROR", "logger": "app", "msg": "UNHANDLED EXCEPTION", "request_id": "fbdbe96eddcd4c30aa457f4e57281712", "exc": "Traceback (most recent call last):\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\flask\\app.py\", line 917, in full_dispatch_request\n    rv = self.dispatch_request()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\flask\\app.py\", line 902, in dispatch_request\n    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]\n  File \"D:\\TestTrackingSystem\\controllers\\auth_helpers.py\", line 133, in wrapper\n    return fn(*args, **kwargs)\n  File \"D:\\TestTrackingSystem\\controllers\\department_controller.py\", line 30, in create_department\n    dept = DepartmentService.create(\n  File \"D:\\TestTrackingSystem\\services\\department_service.py\", line 27, in create\n    dept = DepartmentRepository.create(name=name, code=code, description=description, status=\"active\")\n  File \"D:\\TestTrackingSystem\\repositories\\department_repository.py\", line 19, in create\n    dept = Department(name=name.strip(), code=code.strip() if code else None,\n  File \"<string>\", line 4, in __init__\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\state.py\", line 571, in _initialize_instance\n    with util.safe_reraise():\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\util\\langhelpers.py\", line 224, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\state.py\", line 569, in _initialize_instance\n    manager.original_init(*mixed[1:], **kwargs)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\decl_base.py\", line 2179, in _declarative_constructor\n    raise TypeError(\nTypeError: 'status' is an invalid keyword argument for Department"}
{"ts": "2025-08-22T16:51:06", "level": "ERROR", "logger": "app", "msg": "UNHANDLED EXCEPTION", "request_id": "45f2b31ca2514f038c9a471d5198fea0", "exc": "Traceback (most recent call last):\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\flask\\app.py\", line 917, in full_dispatch_request\n    rv = self.dispatch_request()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\flask\\app.py\", line 902, in dispatch_request\n    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]\n  File \"D:\\TestTrackingSystem\\controllers\\auth_helpers.py\", line 133, in wrapper\n    return fn(*args, **kwargs)\n  File \"D:\\TestTrackingSystem\\controllers\\department_controller.py\", line 30, in create_department\n    dept = DepartmentService.create(\n  File \"D:\\TestTrackingSystem\\services\\department_service.py\", line 27, in create\n    dept = DepartmentRepository.create(name=name, code=code, description=description, status=\"active\")\n  File \"D:\\TestTrackingSystem\\repositories\\department_repository.py\", line 19, in create\n    dept = Department(name=name.strip(), code=code.strip() if code else None,\n  File \"<string>\", line 4, in __init__\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\state.py\", line 571, in _initialize_instance\n    with util.safe_reraise():\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\util\\langhelpers.py\", line 224, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\state.py\", line 569, in _initialize_instance\n    manager.original_init(*mixed[1:], **kwargs)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\decl_base.py\", line 2179, in _declarative_constructor\n    raise TypeError(\nTypeError: 'status' is an invalid keyword argument for Department"}
{"ts": "2025-08-25T18:31:45", "level": "ERROR", "logger": "flask_migrate", "msg": "Error: Directory migrations already exists and is not empty", "request_id": "-"}
{"ts": "2025-08-25T18:32:27", "level": "ERROR", "logger": "flask_migrate", "msg": "Error: Directory migrations already exists and is not empty", "request_id": "-"}
{"ts": "2025-08-25T18:36:15", "level": "ERROR", "logger": "flask_migrate", "msg": "Error: Directory migrations already exists and is not empty", "request_id": "-"}
{"ts": "2025-08-26T18:39:21", "level": "ERROR", "logger": "app", "msg": "UNHANDLED EXCEPTION", "request_id": "f23c002053ab44cc89dbc2255530f6de", "exc": "Traceback (most recent call last):\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 649, in connect\n    sock = socket.create_connection(\n  File \"C:\\Python\\Python310\\lib\\socket.py\", line 845, in create_connection\n    raise err\n  File \"C:\\Python\\Python310\\lib\\socket.py\", line 833, in create_connection\n    sock.connect(sa)\nTimeoutError: timed out\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 143, in __init__\n    self._dbapi_connection = engine.raw_connection()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 3301, in raw_connection\n    return self.pool.connect()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\pool\\base.py\", line 447, in connect\n    return _ConnectionFairy._checkout(self)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\pool\\base.py\", line 1264, in _checkout\n    fairy = _ConnectionRecord.checkout(pool)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\pool\\base.py\", line 716, in checkout\n    with util.safe_reraise():\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\util\\langhelpers.py\", line 224, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\pool\\base.py\", line 714, in checkout\n    dbapi_connection = rec.get_connection()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\pool\\base.py\", line 865, in get_connection\n    self.__connect()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\pool\\base.py\", line 899, in __connect\n    with util.safe_reraise():\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\util\\langhelpers.py\", line 224, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\pool\\base.py\", line 895, in __connect\n    self.dbapi_connection = connection = pool._invoke_creator(self)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\create.py\", line 661, in connect\n    return dialect.connect(*cargs, **cparams)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 629, in connect\n    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 361, in __init__\n    self.connect()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 716, in connect\n    raise exc\npymysql.err.OperationalError: (2003, \"Can't connect to MySQL server on '10.196.155.148' (timed out)\")\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\flask\\app.py\", line 917, in full_dispatch_request\n    rv = self.dispatch_request()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\flask\\app.py\", line 902, in dispatch_request\n    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]\n  File \"D:\\TestTrackingSystem\\controllers\\auth_helpers.py\", line 123, in wrapper\n    user = _resolve_user_from_token(token)\n  File \"D:\\TestTrackingSystem\\controllers\\auth_helpers.py\", line 37, in _resolve_user_from_token\n    user = UserRepository.find_by_id(user_id)\n  File \"D:\\TestTrackingSystem\\repositories\\user_repository.py\", line 28, in find_by_id\n    return User.query.get(user_id)\n  File \"<string>\", line 2, in get\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\util\\deprecations.py\", line 386, in warned\n    return fn(*args, **kwargs)  # type: ignore[no-any-return]\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\query.py\", line 1126, in get\n    return self._get_impl(ident, loading.load_on_pk_identity)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\query.py\", line 1135, in _get_impl\n    return self.session._get_impl(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 3873, in _get_impl\n    return db_load_fn(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\loading.py\", line 695, in load_on_pk_identity\n    session.execute(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2365, in execute\n    return self._execute_internal(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2241, in _execute_internal\n    conn = self._connection_for_bind(bind)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2110, in _connection_for_bind\n    return trans._connection_for_bind(engine, execution_options)\n  File \"<string>\", line 2, in _connection_for_bind\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 137, in _go\n    ret_value = fn(self, *arg, **kw)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1189, in _connection_for_bind\n    conn = bind.connect()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 3277, in connect\n    return self._connection_cls(self)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 145, in __init__\n    Connection._handle_dbapi_exception_noconnection(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2440, in _handle_dbapi_exception_noconnection\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 143, in __init__\n    self._dbapi_connection = engine.raw_connection()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 3301, in raw_connection\n    return self.pool.connect()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\pool\\base.py\", line 447, in connect\n    return _ConnectionFairy._checkout(self)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\pool\\base.py\", line 1264, in _checkout\n    fairy = _ConnectionRecord.checkout(pool)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\pool\\base.py\", line 716, in checkout\n    with util.safe_reraise():\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\util\\langhelpers.py\", line 224, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\pool\\base.py\", line 714, in checkout\n    dbapi_connection = rec.get_connection()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\pool\\base.py\", line 865, in get_connection\n    self.__connect()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\pool\\base.py\", line 899, in __connect\n    with util.safe_reraise():\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\util\\langhelpers.py\", line 224, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\pool\\base.py\", line 895, in __connect\n    self.dbapi_connection = connection = pool._invoke_creator(self)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\create.py\", line 661, in connect\n    return dialect.connect(*cargs, **cparams)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 629, in connect\n    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 361, in __init__\n    self.connect()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 716, in connect\n    raise exc\nsqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2003, \"Can't connect to MySQL server on '10.196.155.148' (timed out)\")\n(Background on this error at: https://sqlalche.me/e/20/e3q8)"}
{"ts": "2025-08-26T18:39:24", "level": "ERROR", "logger": "app", "msg": "UNHANDLED EXCEPTION", "request_id": "641746f1585142758ff6ed20a0faf6bb", "exc": "Traceback (most recent call last):\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 649, in connect\n    sock = socket.create_connection(\n  File \"C:\\Python\\Python310\\lib\\socket.py\", line 845, in create_connection\n    raise err\n  File \"C:\\Python\\Python310\\lib\\socket.py\", line 833, in create_connection\n    sock.connect(sa)\nTimeoutError: timed out\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 143, in __init__\n    self._dbapi_connection = engine.raw_connection()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 3301, in raw_connection\n    return self.pool.connect()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\pool\\base.py\", line 447, in connect\n    return _ConnectionFairy._checkout(self)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\pool\\base.py\", line 1264, in _checkout\n    fairy = _ConnectionRecord.checkout(pool)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\pool\\base.py\", line 711, in checkout\n    rec = pool._do_get()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\pool\\impl.py\", line 177, in _do_get\n    with util.safe_reraise():\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\util\\langhelpers.py\", line 224, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\pool\\impl.py\", line 175, in _do_get\n    return self._create_connection()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\pool\\base.py\", line 388, in _create_connection\n    return _ConnectionRecord(self)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\pool\\base.py\", line 673, in __init__\n    self.__connect()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\pool\\base.py\", line 899, in __connect\n    with util.safe_reraise():\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\util\\langhelpers.py\", line 224, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\pool\\base.py\", line 895, in __connect\n    self.dbapi_connection = connection = pool._invoke_creator(self)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\create.py\", line 661, in connect\n    return dialect.connect(*cargs, **cparams)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 629, in connect\n    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 361, in __init__\n    self.connect()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 716, in connect\n    raise exc\npymysql.err.OperationalError: (2003, \"Can't connect to MySQL server on '10.196.155.148' (timed out)\")\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\flask\\app.py\", line 917, in full_dispatch_request\n    rv = self.dispatch_request()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\flask\\app.py\", line 902, in dispatch_request\n    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]\n  File \"D:\\TestTrackingSystem\\controllers\\auth_helpers.py\", line 123, in wrapper\n    user = _resolve_user_from_token(token)\n  File \"D:\\TestTrackingSystem\\controllers\\auth_helpers.py\", line 37, in _resolve_user_from_token\n    user = UserRepository.find_by_id(user_id)\n  File \"D:\\TestTrackingSystem\\repositories\\user_repository.py\", line 28, in find_by_id\n    return User.query.get(user_id)\n  File \"<string>\", line 2, in get\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\util\\deprecations.py\", line 386, in warned\n    return fn(*args, **kwargs)  # type: ignore[no-any-return]\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\query.py\", line 1126, in get\n    return self._get_impl(ident, loading.load_on_pk_identity)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\query.py\", line 1135, in _get_impl\n    return self.session._get_impl(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 3873, in _get_impl\n    return db_load_fn(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\loading.py\", line 695, in load_on_pk_identity\n    session.execute(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2365, in execute\n    return self._execute_internal(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2241, in _execute_internal\n    conn = self._connection_for_bind(bind)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2110, in _connection_for_bind\n    return trans._connection_for_bind(engine, execution_options)\n  File \"<string>\", line 2, in _connection_for_bind\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 137, in _go\n    ret_value = fn(self, *arg, **kw)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1189, in _connection_for_bind\n    conn = bind.connect()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 3277, in connect\n    return self._connection_cls(self)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 145, in __init__\n    Connection._handle_dbapi_exception_noconnection(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2440, in _handle_dbapi_exception_noconnection\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 143, in __init__\n    self._dbapi_connection = engine.raw_connection()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 3301, in raw_connection\n    return self.pool.connect()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\pool\\base.py\", line 447, in connect\n    return _ConnectionFairy._checkout(self)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\pool\\base.py\", line 1264, in _checkout\n    fairy = _ConnectionRecord.checkout(pool)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\pool\\base.py\", line 711, in checkout\n    rec = pool._do_get()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\pool\\impl.py\", line 177, in _do_get\n    with util.safe_reraise():\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\util\\langhelpers.py\", line 224, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\pool\\impl.py\", line 175, in _do_get\n    return self._create_connection()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\pool\\base.py\", line 388, in _create_connection\n    return _ConnectionRecord(self)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\pool\\base.py\", line 673, in __init__\n    self.__connect()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\pool\\base.py\", line 899, in __connect\n    with util.safe_reraise():\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\util\\langhelpers.py\", line 224, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\pool\\base.py\", line 895, in __connect\n    self.dbapi_connection = connection = pool._invoke_creator(self)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\create.py\", line 661, in connect\n    return dialect.connect(*cargs, **cparams)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 629, in connect\n    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 361, in __init__\n    self.connect()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 716, in connect\n    raise exc\nsqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2003, \"Can't connect to MySQL server on '10.196.155.148' (timed out)\")\n(Background on this error at: https://sqlalche.me/e/20/e3q8)"}
{"ts": "2025-08-26T18:39:34", "level": "ERROR", "logger": "app", "msg": "UNHANDLED EXCEPTION", "request_id": "57ee082cb52f41ada8f3e8540dcfac86", "exc": "Traceback (most recent call last):\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 649, in connect\n    sock = socket.create_connection(\n  File \"C:\\Python\\Python310\\lib\\socket.py\", line 845, in create_connection\n    raise err\n  File \"C:\\Python\\Python310\\lib\\socket.py\", line 833, in create_connection\n    sock.connect(sa)\nConnectionAbortedError: [WinError 10053] 你的主机中的软件中止了一个已建立的连接。\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 143, in __init__\n    self._dbapi_connection = engine.raw_connection()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 3301, in raw_connection\n    return self.pool.connect()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\pool\\base.py\", line 447, in connect\n    return _ConnectionFairy._checkout(self)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\pool\\base.py\", line 1264, in _checkout\n    fairy = _ConnectionRecord.checkout(pool)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\pool\\base.py\", line 716, in checkout\n    with util.safe_reraise():\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\util\\langhelpers.py\", line 224, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\pool\\base.py\", line 714, in checkout\n    dbapi_connection = rec.get_connection()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\pool\\base.py\", line 836, in get_connection\n    self.__connect()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\pool\\base.py\", line 899, in __connect\n    with util.safe_reraise():\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\util\\langhelpers.py\", line 224, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\pool\\base.py\", line 895, in __connect\n    self.dbapi_connection = connection = pool._invoke_creator(self)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\create.py\", line 661, in connect\n    return dialect.connect(*cargs, **cparams)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 629, in connect\n    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 361, in __init__\n    self.connect()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 716, in connect\n    raise exc\npymysql.err.OperationalError: (2003, \"Can't connect to MySQL server on '10.196.155.148' ([WinError 10053] 你的主机中的软件中止了一个已建立的连接。)\")\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\flask\\app.py\", line 917, in full_dispatch_request\n    rv = self.dispatch_request()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\flask\\app.py\", line 902, in dispatch_request\n    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]\n  File \"D:\\TestTrackingSystem\\controllers\\auth_helpers.py\", line 123, in wrapper\n    user = _resolve_user_from_token(token)\n  File \"D:\\TestTrackingSystem\\controllers\\auth_helpers.py\", line 37, in _resolve_user_from_token\n    user = UserRepository.find_by_id(user_id)\n  File \"D:\\TestTrackingSystem\\repositories\\user_repository.py\", line 28, in find_by_id\n    return User.query.get(user_id)\n  File \"<string>\", line 2, in get\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\util\\deprecations.py\", line 386, in warned\n    return fn(*args, **kwargs)  # type: ignore[no-any-return]\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\query.py\", line 1126, in get\n    return self._get_impl(ident, loading.load_on_pk_identity)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\query.py\", line 1135, in _get_impl\n    return self.session._get_impl(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 3873, in _get_impl\n    return db_load_fn(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\loading.py\", line 695, in load_on_pk_identity\n    session.execute(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2365, in execute\n    return self._execute_internal(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2241, in _execute_internal\n    conn = self._connection_for_bind(bind)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2110, in _connection_for_bind\n    return trans._connection_for_bind(engine, execution_options)\n  File \"<string>\", line 2, in _connection_for_bind\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 137, in _go\n    ret_value = fn(self, *arg, **kw)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1189, in _connection_for_bind\n    conn = bind.connect()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 3277, in connect\n    return self._connection_cls(self)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 145, in __init__\n    Connection._handle_dbapi_exception_noconnection(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2440, in _handle_dbapi_exception_noconnection\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 143, in __init__\n    self._dbapi_connection = engine.raw_connection()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 3301, in raw_connection\n    return self.pool.connect()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\pool\\base.py\", line 447, in connect\n    return _ConnectionFairy._checkout(self)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\pool\\base.py\", line 1264, in _checkout\n    fairy = _ConnectionRecord.checkout(pool)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\pool\\base.py\", line 716, in checkout\n    with util.safe_reraise():\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\util\\langhelpers.py\", line 224, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\pool\\base.py\", line 714, in checkout\n    dbapi_connection = rec.get_connection()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\pool\\base.py\", line 836, in get_connection\n    self.__connect()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\pool\\base.py\", line 899, in __connect\n    with util.safe_reraise():\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\util\\langhelpers.py\", line 224, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\pool\\base.py\", line 895, in __connect\n    self.dbapi_connection = connection = pool._invoke_creator(self)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\create.py\", line 661, in connect\n    return dialect.connect(*cargs, **cparams)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 629, in connect\n    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 361, in __init__\n    self.connect()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 716, in connect\n    raise exc\nsqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2003, \"Can't connect to MySQL server on '10.196.155.148' ([WinError 10053] 你的主机中的软件中止了一个已建立的连接。)\")\n(Background on this error at: https://sqlalche.me/e/20/e3q8)"}
{"ts": "2025-08-27T17:07:15", "level": "ERROR", "logger": "app", "msg": "UNHANDLED EXCEPTION", "request_id": "70f3a79b36fd4de69a91f9fc6eef9444", "exc": "Traceback (most recent call last):\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 951, in do_execute\n    cursor.execute(statement, parameters)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\cursors.py\", line 153, in execute\n    result = self._query(query)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\cursors.py\", line 322, in _query\n    conn.query(q)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 563, in query\n    self._affected_rows = self._read_query_result(unbuffered=unbuffered)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 825, in _read_query_result\n    result.read()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 1199, in read\n    first_packet = self.connection._read_packet()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 775, in _read_packet\n    packet.raise_for_error()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\protocol.py\", line 219, in raise_for_error\n    err.raise_mysql_exception(self._data)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\err.py\", line 150, in raise_mysql_exception\n    raise errorclass(errno, errval)\npymysql.err.IntegrityError: (1452, 'Cannot add or update a child row: a foreign key constraint fails (`patvs_test`.`test_case`, CONSTRAINT `fk_test_case_department_id_department` FOREIGN KEY (`department_id`) REFERENCES `department` (`id`) ON DELETE CASCADE)')\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\flask\\app.py\", line 917, in full_dispatch_request\n    rv = self.dispatch_request()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\flask\\app.py\", line 902, in dispatch_request\n    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]\n  File \"D:\\TestTrackingSystem\\controllers\\auth_helpers.py\", line 133, in wrapper\n    return fn(*args, **kwargs)\n  File \"D:\\TestTrackingSystem\\controllers\\test_case_controller.py\", line 50, in create_test_case\n    test_case = TestCaseService.create(\n  File \"D:\\TestTrackingSystem\\services\\test_case_service.py\", line 75, in create\n    test_case = TestCaseRepository.create(\n  File \"D:\\TestTrackingSystem\\repositories\\test_case_repository.py\", line 39, in create\n    db.session.commit()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\scoping.py\", line 599, in commit\n    return self._proxied.commit()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2032, in commit\n    trans.commit(_to_root=True)\n  File \"<string>\", line 2, in commit\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 137, in _go\n    ret_value = fn(self, *arg, **kw)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1313, in commit\n    self._prepare_impl()\n  File \"<string>\", line 2, in _prepare_impl\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 137, in _go\n    ret_value = fn(self, *arg, **kw)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1288, in _prepare_impl\n    self.session.flush()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4345, in flush\n    self._flush(objects)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4480, in _flush\n    with util.safe_reraise():\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\util\\langhelpers.py\", line 224, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4441, in _flush\n    flush_context.execute()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 466, in execute\n    rec.execute(self)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 1233, in _emit_insert_statements\n    result = connection.execute(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1419, in execute\n    return meth(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\sql\\elements.py\", line 526, in _execute_on_connection\n    return connection._execute_clauseelement(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1641, in _execute_clauseelement\n    ret = self._execute_context(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1846, in _execute_context\n    return self._exec_single_context(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1986, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2355, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 951, in do_execute\n    cursor.execute(statement, parameters)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\cursors.py\", line 153, in execute\n    result = self._query(query)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\cursors.py\", line 322, in _query\n    conn.query(q)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 563, in query\n    self._affected_rows = self._read_query_result(unbuffered=unbuffered)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 825, in _read_query_result\n    result.read()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 1199, in read\n    first_packet = self.connection._read_packet()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 775, in _read_packet\n    packet.raise_for_error()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\protocol.py\", line 219, in raise_for_error\n    err.raise_mysql_exception(self._data)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\err.py\", line 150, in raise_mysql_exception\n    raise errorclass(errno, errval)\nsqlalchemy.exc.IntegrityError: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`patvs_test`.`test_case`, CONSTRAINT `fk_test_case_department_id_department` FOREIGN KEY (`department_id`) REFERENCES `department` (`id`) ON DELETE CASCADE)')\n[SQL: INSERT INTO test_case (department_id, group_id, title, preconditions, steps, expected_result, keywords, priority, status, case_type, workload_minutes, created_by, updated_by, deleted_at, deleted_by) VALUES (%(department_id)s, %(group_id)s, %(title)s, %(preconditions)s, %(steps)s, %(expected_result)s, %(keywords)s, %(priority)s, %(status)s, %(case_type)s, %(workload_minutes)s, %(created_by)s, %(updated_by)s, %(deleted_at)s, %(deleted_by)s)]\n[parameters: {'department_id': 13, 'group_id': None, 'title': '登录用例_4774d8dd', 'preconditions': '浏览器已打开', 'steps': '[{\"no\": 1, \"action\": \"\\\\u6253\\\\u5f00\\\\u767b\\\\u5f55\\\\u9875\\\\u9762\", \"keyword\": \"\\\\u6253\\\\u5f00\", \"note\": \"\\\\u786e\\\\u4fdd\\\\u9875\\\\u9762\\\\u52a0\\\\u8f7d\\\\ ... (632 characters truncated) ... \\u70b9\\\\u51fb\", \"note\": \"\\\\u70b9\\\\u51fb\\\\u767b\\\\u5f55\\\\u6309\\\\u94ae\\\\u63d0\\\\u4ea4\\\\u8868\\\\u5355\", \"expected\": \"\\\\u8df3\\\\u8f6c\\\\u5230\\\\u9996\\\\u9875\"}]', 'expected_result': '登录成功后进入首页', 'keywords': '[\"\\\\u767b\\\\u5f55\", \"\\\\u6b63\\\\u5411\"]', 'priority': 'P2', 'status': 'active', 'case_type': 'functional', 'workload_minutes': None, 'created_by': 1, 'updated_by': 1, 'deleted_at': None, 'deleted_by': None}]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)"}
{"ts": "2025-08-27T17:07:16", "level": "ERROR", "logger": "app", "msg": "UNHANDLED EXCEPTION", "request_id": "93bfb7fe33f64ffeafba6bd0e644e7f4", "exc": "Traceback (most recent call last):\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 951, in do_execute\n    cursor.execute(statement, parameters)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\cursors.py\", line 153, in execute\n    result = self._query(query)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\cursors.py\", line 322, in _query\n    conn.query(q)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 563, in query\n    self._affected_rows = self._read_query_result(unbuffered=unbuffered)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 825, in _read_query_result\n    result.read()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 1199, in read\n    first_packet = self.connection._read_packet()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 775, in _read_packet\n    packet.raise_for_error()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\protocol.py\", line 219, in raise_for_error\n    err.raise_mysql_exception(self._data)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\err.py\", line 150, in raise_mysql_exception\n    raise errorclass(errno, errval)\npymysql.err.IntegrityError: (1452, 'Cannot add or update a child row: a foreign key constraint fails (`patvs_test`.`test_case`, CONSTRAINT `fk_test_case_department_id_department` FOREIGN KEY (`department_id`) REFERENCES `department` (`id`) ON DELETE CASCADE)')\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\flask\\app.py\", line 917, in full_dispatch_request\n    rv = self.dispatch_request()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\flask\\app.py\", line 902, in dispatch_request\n    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]\n  File \"D:\\TestTrackingSystem\\controllers\\auth_helpers.py\", line 133, in wrapper\n    return fn(*args, **kwargs)\n  File \"D:\\TestTrackingSystem\\controllers\\test_case_controller.py\", line 50, in create_test_case\n    test_case = TestCaseService.create(\n  File \"D:\\TestTrackingSystem\\services\\test_case_service.py\", line 75, in create\n    test_case = TestCaseRepository.create(\n  File \"D:\\TestTrackingSystem\\repositories\\test_case_repository.py\", line 39, in create\n    db.session.commit()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\scoping.py\", line 599, in commit\n    return self._proxied.commit()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2032, in commit\n    trans.commit(_to_root=True)\n  File \"<string>\", line 2, in commit\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 137, in _go\n    ret_value = fn(self, *arg, **kw)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1313, in commit\n    self._prepare_impl()\n  File \"<string>\", line 2, in _prepare_impl\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 137, in _go\n    ret_value = fn(self, *arg, **kw)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1288, in _prepare_impl\n    self.session.flush()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4345, in flush\n    self._flush(objects)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4480, in _flush\n    with util.safe_reraise():\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\util\\langhelpers.py\", line 224, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4441, in _flush\n    flush_context.execute()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 466, in execute\n    rec.execute(self)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 1233, in _emit_insert_statements\n    result = connection.execute(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1419, in execute\n    return meth(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\sql\\elements.py\", line 526, in _execute_on_connection\n    return connection._execute_clauseelement(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1641, in _execute_clauseelement\n    ret = self._execute_context(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1846, in _execute_context\n    return self._exec_single_context(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1986, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2355, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 951, in do_execute\n    cursor.execute(statement, parameters)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\cursors.py\", line 153, in execute\n    result = self._query(query)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\cursors.py\", line 322, in _query\n    conn.query(q)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 563, in query\n    self._affected_rows = self._read_query_result(unbuffered=unbuffered)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 825, in _read_query_result\n    result.read()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 1199, in read\n    first_packet = self.connection._read_packet()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 775, in _read_packet\n    packet.raise_for_error()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\protocol.py\", line 219, in raise_for_error\n    err.raise_mysql_exception(self._data)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\err.py\", line 150, in raise_mysql_exception\n    raise errorclass(errno, errval)\nsqlalchemy.exc.IntegrityError: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`patvs_test`.`test_case`, CONSTRAINT `fk_test_case_department_id_department` FOREIGN KEY (`department_id`) REFERENCES `department` (`id`) ON DELETE CASCADE)')\n[SQL: INSERT INTO test_case (department_id, group_id, title, preconditions, steps, expected_result, keywords, priority, status, case_type, workload_minutes, created_by, updated_by, deleted_at, deleted_by) VALUES (%(department_id)s, %(group_id)s, %(title)s, %(preconditions)s, %(steps)s, %(expected_result)s, %(keywords)s, %(priority)s, %(status)s, %(case_type)s, %(workload_minutes)s, %(created_by)s, %(updated_by)s, %(deleted_at)s, %(deleted_by)s)]\n[parameters: {'department_id': 13, 'group_id': None, 'title': '登录用例_cc5acdbc', 'preconditions': '浏览器已打开', 'steps': '[{\"no\": 1, \"action\": \"\\\\u6253\\\\u5f00\\\\u767b\\\\u5f55\\\\u9875\\\\u9762\", \"keyword\": \"\\\\u6253\\\\u5f00\", \"note\": \"\\\\u786e\\\\u4fdd\\\\u9875\\\\u9762\\\\u52a0\\\\u8f7d\\\\ ... (632 characters truncated) ... \\u70b9\\\\u51fb\", \"note\": \"\\\\u70b9\\\\u51fb\\\\u767b\\\\u5f55\\\\u6309\\\\u94ae\\\\u63d0\\\\u4ea4\\\\u8868\\\\u5355\", \"expected\": \"\\\\u8df3\\\\u8f6c\\\\u5230\\\\u9996\\\\u9875\"}]', 'expected_result': '登录成功后进入首页', 'keywords': '[\"\\\\u767b\\\\u5f55\", \"\\\\u6b63\\\\u5411\"]', 'priority': 'P2', 'status': 'active', 'case_type': 'functional', 'workload_minutes': None, 'created_by': 1, 'updated_by': 1, 'deleted_at': None, 'deleted_by': None}]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)"}
{"ts": "2025-08-27T17:07:16", "level": "ERROR", "logger": "app", "msg": "UNHANDLED EXCEPTION", "request_id": "fbe7d6c78a594bd9876ae9c669786c63", "exc": "Traceback (most recent call last):\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 951, in do_execute\n    cursor.execute(statement, parameters)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\cursors.py\", line 153, in execute\n    result = self._query(query)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\cursors.py\", line 322, in _query\n    conn.query(q)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 563, in query\n    self._affected_rows = self._read_query_result(unbuffered=unbuffered)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 825, in _read_query_result\n    result.read()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 1199, in read\n    first_packet = self.connection._read_packet()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 775, in _read_packet\n    packet.raise_for_error()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\protocol.py\", line 219, in raise_for_error\n    err.raise_mysql_exception(self._data)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\err.py\", line 150, in raise_mysql_exception\n    raise errorclass(errno, errval)\npymysql.err.IntegrityError: (1452, 'Cannot add or update a child row: a foreign key constraint fails (`patvs_test`.`test_case`, CONSTRAINT `fk_test_case_department_id_department` FOREIGN KEY (`department_id`) REFERENCES `department` (`id`) ON DELETE CASCADE)')\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\flask\\app.py\", line 917, in full_dispatch_request\n    rv = self.dispatch_request()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\flask\\app.py\", line 902, in dispatch_request\n    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]\n  File \"D:\\TestTrackingSystem\\controllers\\auth_helpers.py\", line 133, in wrapper\n    return fn(*args, **kwargs)\n  File \"D:\\TestTrackingSystem\\controllers\\test_case_controller.py\", line 50, in create_test_case\n    test_case = TestCaseService.create(\n  File \"D:\\TestTrackingSystem\\services\\test_case_service.py\", line 75, in create\n    test_case = TestCaseRepository.create(\n  File \"D:\\TestTrackingSystem\\repositories\\test_case_repository.py\", line 39, in create\n    db.session.commit()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\scoping.py\", line 599, in commit\n    return self._proxied.commit()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2032, in commit\n    trans.commit(_to_root=True)\n  File \"<string>\", line 2, in commit\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 137, in _go\n    ret_value = fn(self, *arg, **kw)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1313, in commit\n    self._prepare_impl()\n  File \"<string>\", line 2, in _prepare_impl\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 137, in _go\n    ret_value = fn(self, *arg, **kw)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1288, in _prepare_impl\n    self.session.flush()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4345, in flush\n    self._flush(objects)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4480, in _flush\n    with util.safe_reraise():\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\util\\langhelpers.py\", line 224, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4441, in _flush\n    flush_context.execute()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 466, in execute\n    rec.execute(self)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 1233, in _emit_insert_statements\n    result = connection.execute(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1419, in execute\n    return meth(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\sql\\elements.py\", line 526, in _execute_on_connection\n    return connection._execute_clauseelement(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1641, in _execute_clauseelement\n    ret = self._execute_context(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1846, in _execute_context\n    return self._exec_single_context(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1986, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2355, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 951, in do_execute\n    cursor.execute(statement, parameters)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\cursors.py\", line 153, in execute\n    result = self._query(query)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\cursors.py\", line 322, in _query\n    conn.query(q)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 563, in query\n    self._affected_rows = self._read_query_result(unbuffered=unbuffered)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 825, in _read_query_result\n    result.read()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 1199, in read\n    first_packet = self.connection._read_packet()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 775, in _read_packet\n    packet.raise_for_error()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\protocol.py\", line 219, in raise_for_error\n    err.raise_mysql_exception(self._data)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\err.py\", line 150, in raise_mysql_exception\n    raise errorclass(errno, errval)\nsqlalchemy.exc.IntegrityError: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`patvs_test`.`test_case`, CONSTRAINT `fk_test_case_department_id_department` FOREIGN KEY (`department_id`) REFERENCES `department` (`id`) ON DELETE CASCADE)')\n[SQL: INSERT INTO test_case (department_id, group_id, title, preconditions, steps, expected_result, keywords, priority, status, case_type, workload_minutes, created_by, updated_by, deleted_at, deleted_by) VALUES (%(department_id)s, %(group_id)s, %(title)s, %(preconditions)s, %(steps)s, %(expected_result)s, %(keywords)s, %(priority)s, %(status)s, %(case_type)s, %(workload_minutes)s, %(created_by)s, %(updated_by)s, %(deleted_at)s, %(deleted_by)s)]\n[parameters: {'department_id': 13, 'group_id': None, 'title': '登录用例_e696ca9c', 'preconditions': '浏览器已打开', 'steps': '[{\"no\": 1, \"action\": \"\\\\u6253\\\\u5f00\\\\u767b\\\\u5f55\\\\u9875\\\\u9762\", \"keyword\": \"\\\\u6253\\\\u5f00\", \"note\": \"\\\\u786e\\\\u4fdd\\\\u9875\\\\u9762\\\\u52a0\\\\u8f7d\\\\ ... (632 characters truncated) ... \\u70b9\\\\u51fb\", \"note\": \"\\\\u70b9\\\\u51fb\\\\u767b\\\\u5f55\\\\u6309\\\\u94ae\\\\u63d0\\\\u4ea4\\\\u8868\\\\u5355\", \"expected\": \"\\\\u8df3\\\\u8f6c\\\\u5230\\\\u9996\\\\u9875\"}]', 'expected_result': '登录成功后进入首页', 'keywords': '[\"\\\\u767b\\\\u5f55\", \"\\\\u6b63\\\\u5411\"]', 'priority': 'P2', 'status': 'active', 'case_type': 'functional', 'workload_minutes': None, 'created_by': 1, 'updated_by': 1, 'deleted_at': None, 'deleted_by': None}]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)"}
{"ts": "2025-08-27T17:07:16", "level": "ERROR", "logger": "app", "msg": "UNHANDLED EXCEPTION", "request_id": "8e538dfd46cb4348b2ade35741e40503", "exc": "Traceback (most recent call last):\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 951, in do_execute\n    cursor.execute(statement, parameters)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\cursors.py\", line 153, in execute\n    result = self._query(query)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\cursors.py\", line 322, in _query\n    conn.query(q)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 563, in query\n    self._affected_rows = self._read_query_result(unbuffered=unbuffered)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 825, in _read_query_result\n    result.read()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 1199, in read\n    first_packet = self.connection._read_packet()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 775, in _read_packet\n    packet.raise_for_error()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\protocol.py\", line 219, in raise_for_error\n    err.raise_mysql_exception(self._data)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\err.py\", line 150, in raise_mysql_exception\n    raise errorclass(errno, errval)\npymysql.err.IntegrityError: (1452, 'Cannot add or update a child row: a foreign key constraint fails (`patvs_test`.`test_case`, CONSTRAINT `fk_test_case_department_id_department` FOREIGN KEY (`department_id`) REFERENCES `department` (`id`) ON DELETE CASCADE)')\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\flask\\app.py\", line 917, in full_dispatch_request\n    rv = self.dispatch_request()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\flask\\app.py\", line 902, in dispatch_request\n    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]\n  File \"D:\\TestTrackingSystem\\controllers\\auth_helpers.py\", line 133, in wrapper\n    return fn(*args, **kwargs)\n  File \"D:\\TestTrackingSystem\\controllers\\test_case_controller.py\", line 50, in create_test_case\n    test_case = TestCaseService.create(\n  File \"D:\\TestTrackingSystem\\services\\test_case_service.py\", line 75, in create\n    test_case = TestCaseRepository.create(\n  File \"D:\\TestTrackingSystem\\repositories\\test_case_repository.py\", line 39, in create\n    db.session.commit()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\scoping.py\", line 599, in commit\n    return self._proxied.commit()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2032, in commit\n    trans.commit(_to_root=True)\n  File \"<string>\", line 2, in commit\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 137, in _go\n    ret_value = fn(self, *arg, **kw)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1313, in commit\n    self._prepare_impl()\n  File \"<string>\", line 2, in _prepare_impl\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 137, in _go\n    ret_value = fn(self, *arg, **kw)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1288, in _prepare_impl\n    self.session.flush()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4345, in flush\n    self._flush(objects)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4480, in _flush\n    with util.safe_reraise():\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\util\\langhelpers.py\", line 224, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4441, in _flush\n    flush_context.execute()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 466, in execute\n    rec.execute(self)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 1233, in _emit_insert_statements\n    result = connection.execute(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1419, in execute\n    return meth(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\sql\\elements.py\", line 526, in _execute_on_connection\n    return connection._execute_clauseelement(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1641, in _execute_clauseelement\n    ret = self._execute_context(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1846, in _execute_context\n    return self._exec_single_context(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1986, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2355, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 951, in do_execute\n    cursor.execute(statement, parameters)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\cursors.py\", line 153, in execute\n    result = self._query(query)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\cursors.py\", line 322, in _query\n    conn.query(q)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 563, in query\n    self._affected_rows = self._read_query_result(unbuffered=unbuffered)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 825, in _read_query_result\n    result.read()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 1199, in read\n    first_packet = self.connection._read_packet()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 775, in _read_packet\n    packet.raise_for_error()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\protocol.py\", line 219, in raise_for_error\n    err.raise_mysql_exception(self._data)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\err.py\", line 150, in raise_mysql_exception\n    raise errorclass(errno, errval)\nsqlalchemy.exc.IntegrityError: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`patvs_test`.`test_case`, CONSTRAINT `fk_test_case_department_id_department` FOREIGN KEY (`department_id`) REFERENCES `department` (`id`) ON DELETE CASCADE)')\n[SQL: INSERT INTO test_case (department_id, group_id, title, preconditions, steps, expected_result, keywords, priority, status, case_type, workload_minutes, created_by, updated_by, deleted_at, deleted_by) VALUES (%(department_id)s, %(group_id)s, %(title)s, %(preconditions)s, %(steps)s, %(expected_result)s, %(keywords)s, %(priority)s, %(status)s, %(case_type)s, %(workload_minutes)s, %(created_by)s, %(updated_by)s, %(deleted_at)s, %(deleted_by)s)]\n[parameters: {'department_id': 13, 'group_id': None, 'title': '登录用例_6df482e8', 'preconditions': '浏览器已打开', 'steps': '[{\"no\": 1, \"action\": \"\\\\u6253\\\\u5f00\\\\u767b\\\\u5f55\\\\u9875\\\\u9762\", \"keyword\": \"\\\\u6253\\\\u5f00\", \"note\": \"\\\\u786e\\\\u4fdd\\\\u9875\\\\u9762\\\\u52a0\\\\u8f7d\\\\ ... (632 characters truncated) ... \\u70b9\\\\u51fb\", \"note\": \"\\\\u70b9\\\\u51fb\\\\u767b\\\\u5f55\\\\u6309\\\\u94ae\\\\u63d0\\\\u4ea4\\\\u8868\\\\u5355\", \"expected\": \"\\\\u8df3\\\\u8f6c\\\\u5230\\\\u9996\\\\u9875\"}]', 'expected_result': '登录成功后进入首页', 'keywords': '[\"\\\\u767b\\\\u5f55\", \"\\\\u6b63\\\\u5411\"]', 'priority': 'P2', 'status': 'active', 'case_type': 'functional', 'workload_minutes': None, 'created_by': 1, 'updated_by': 1, 'deleted_at': None, 'deleted_by': None}]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)"}
{"ts": "2025-08-27T17:07:16", "level": "ERROR", "logger": "app", "msg": "UNHANDLED EXCEPTION", "request_id": "fef2aaa9405b49238d46cc1b6f135ae9", "exc": "Traceback (most recent call last):\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 951, in do_execute\n    cursor.execute(statement, parameters)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\cursors.py\", line 153, in execute\n    result = self._query(query)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\cursors.py\", line 322, in _query\n    conn.query(q)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 563, in query\n    self._affected_rows = self._read_query_result(unbuffered=unbuffered)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 825, in _read_query_result\n    result.read()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 1199, in read\n    first_packet = self.connection._read_packet()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 775, in _read_packet\n    packet.raise_for_error()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\protocol.py\", line 219, in raise_for_error\n    err.raise_mysql_exception(self._data)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\err.py\", line 150, in raise_mysql_exception\n    raise errorclass(errno, errval)\npymysql.err.IntegrityError: (1452, 'Cannot add or update a child row: a foreign key constraint fails (`patvs_test`.`test_case`, CONSTRAINT `fk_test_case_department_id_department` FOREIGN KEY (`department_id`) REFERENCES `department` (`id`) ON DELETE CASCADE)')\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\flask\\app.py\", line 917, in full_dispatch_request\n    rv = self.dispatch_request()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\flask\\app.py\", line 902, in dispatch_request\n    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]\n  File \"D:\\TestTrackingSystem\\controllers\\auth_helpers.py\", line 133, in wrapper\n    return fn(*args, **kwargs)\n  File \"D:\\TestTrackingSystem\\controllers\\test_case_controller.py\", line 50, in create_test_case\n    test_case = TestCaseService.create(\n  File \"D:\\TestTrackingSystem\\services\\test_case_service.py\", line 75, in create\n    test_case = TestCaseRepository.create(\n  File \"D:\\TestTrackingSystem\\repositories\\test_case_repository.py\", line 39, in create\n    db.session.commit()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\scoping.py\", line 599, in commit\n    return self._proxied.commit()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2032, in commit\n    trans.commit(_to_root=True)\n  File \"<string>\", line 2, in commit\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 137, in _go\n    ret_value = fn(self, *arg, **kw)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1313, in commit\n    self._prepare_impl()\n  File \"<string>\", line 2, in _prepare_impl\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 137, in _go\n    ret_value = fn(self, *arg, **kw)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1288, in _prepare_impl\n    self.session.flush()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4345, in flush\n    self._flush(objects)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4480, in _flush\n    with util.safe_reraise():\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\util\\langhelpers.py\", line 224, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4441, in _flush\n    flush_context.execute()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 466, in execute\n    rec.execute(self)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 1233, in _emit_insert_statements\n    result = connection.execute(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1419, in execute\n    return meth(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\sql\\elements.py\", line 526, in _execute_on_connection\n    return connection._execute_clauseelement(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1641, in _execute_clauseelement\n    ret = self._execute_context(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1846, in _execute_context\n    return self._exec_single_context(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1986, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2355, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 951, in do_execute\n    cursor.execute(statement, parameters)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\cursors.py\", line 153, in execute\n    result = self._query(query)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\cursors.py\", line 322, in _query\n    conn.query(q)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 563, in query\n    self._affected_rows = self._read_query_result(unbuffered=unbuffered)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 825, in _read_query_result\n    result.read()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 1199, in read\n    first_packet = self.connection._read_packet()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 775, in _read_packet\n    packet.raise_for_error()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\protocol.py\", line 219, in raise_for_error\n    err.raise_mysql_exception(self._data)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\err.py\", line 150, in raise_mysql_exception\n    raise errorclass(errno, errval)\nsqlalchemy.exc.IntegrityError: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`patvs_test`.`test_case`, CONSTRAINT `fk_test_case_department_id_department` FOREIGN KEY (`department_id`) REFERENCES `department` (`id`) ON DELETE CASCADE)')\n[SQL: INSERT INTO test_case (department_id, group_id, title, preconditions, steps, expected_result, keywords, priority, status, case_type, workload_minutes, created_by, updated_by, deleted_at, deleted_by) VALUES (%(department_id)s, %(group_id)s, %(title)s, %(preconditions)s, %(steps)s, %(expected_result)s, %(keywords)s, %(priority)s, %(status)s, %(case_type)s, %(workload_minutes)s, %(created_by)s, %(updated_by)s, %(deleted_at)s, %(deleted_by)s)]\n[parameters: {'department_id': 13, 'group_id': None, 'title': '登录用例_c707e3cb', 'preconditions': '浏览器已打开', 'steps': '[{\"no\": 1, \"action\": \"\\\\u6253\\\\u5f00\\\\u767b\\\\u5f55\\\\u9875\\\\u9762\", \"keyword\": \"\\\\u6253\\\\u5f00\", \"note\": \"\\\\u786e\\\\u4fdd\\\\u9875\\\\u9762\\\\u52a0\\\\u8f7d\\\\ ... (632 characters truncated) ... \\u70b9\\\\u51fb\", \"note\": \"\\\\u70b9\\\\u51fb\\\\u767b\\\\u5f55\\\\u6309\\\\u94ae\\\\u63d0\\\\u4ea4\\\\u8868\\\\u5355\", \"expected\": \"\\\\u8df3\\\\u8f6c\\\\u5230\\\\u9996\\\\u9875\"}]', 'expected_result': '登录成功后进入首页', 'keywords': '[\"\\\\u767b\\\\u5f55\", \"\\\\u6b63\\\\u5411\"]', 'priority': 'P2', 'status': 'active', 'case_type': 'functional', 'workload_minutes': None, 'created_by': 1, 'updated_by': 1, 'deleted_at': None, 'deleted_by': None}]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)"}
{"ts": "2025-08-27T17:07:17", "level": "ERROR", "logger": "app", "msg": "UNHANDLED EXCEPTION", "request_id": "da2bcc51afaa4166abef7cfddb3ca6d4", "exc": "Traceback (most recent call last):\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 951, in do_execute\n    cursor.execute(statement, parameters)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\cursors.py\", line 153, in execute\n    result = self._query(query)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\cursors.py\", line 322, in _query\n    conn.query(q)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 563, in query\n    self._affected_rows = self._read_query_result(unbuffered=unbuffered)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 825, in _read_query_result\n    result.read()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 1199, in read\n    first_packet = self.connection._read_packet()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 775, in _read_packet\n    packet.raise_for_error()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\protocol.py\", line 219, in raise_for_error\n    err.raise_mysql_exception(self._data)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\err.py\", line 150, in raise_mysql_exception\n    raise errorclass(errno, errval)\npymysql.err.IntegrityError: (1452, 'Cannot add or update a child row: a foreign key constraint fails (`patvs_test`.`test_case`, CONSTRAINT `fk_test_case_department_id_department` FOREIGN KEY (`department_id`) REFERENCES `department` (`id`) ON DELETE CASCADE)')\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\flask\\app.py\", line 917, in full_dispatch_request\n    rv = self.dispatch_request()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\flask\\app.py\", line 902, in dispatch_request\n    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]\n  File \"D:\\TestTrackingSystem\\controllers\\auth_helpers.py\", line 133, in wrapper\n    return fn(*args, **kwargs)\n  File \"D:\\TestTrackingSystem\\controllers\\test_case_controller.py\", line 50, in create_test_case\n    test_case = TestCaseService.create(\n  File \"D:\\TestTrackingSystem\\services\\test_case_service.py\", line 75, in create\n    test_case = TestCaseRepository.create(\n  File \"D:\\TestTrackingSystem\\repositories\\test_case_repository.py\", line 39, in create\n    db.session.commit()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\scoping.py\", line 599, in commit\n    return self._proxied.commit()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2032, in commit\n    trans.commit(_to_root=True)\n  File \"<string>\", line 2, in commit\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 137, in _go\n    ret_value = fn(self, *arg, **kw)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1313, in commit\n    self._prepare_impl()\n  File \"<string>\", line 2, in _prepare_impl\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 137, in _go\n    ret_value = fn(self, *arg, **kw)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1288, in _prepare_impl\n    self.session.flush()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4345, in flush\n    self._flush(objects)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4480, in _flush\n    with util.safe_reraise():\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\util\\langhelpers.py\", line 224, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4441, in _flush\n    flush_context.execute()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 466, in execute\n    rec.execute(self)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 1233, in _emit_insert_statements\n    result = connection.execute(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1419, in execute\n    return meth(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\sql\\elements.py\", line 526, in _execute_on_connection\n    return connection._execute_clauseelement(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1641, in _execute_clauseelement\n    ret = self._execute_context(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1846, in _execute_context\n    return self._exec_single_context(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1986, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2355, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 951, in do_execute\n    cursor.execute(statement, parameters)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\cursors.py\", line 153, in execute\n    result = self._query(query)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\cursors.py\", line 322, in _query\n    conn.query(q)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 563, in query\n    self._affected_rows = self._read_query_result(unbuffered=unbuffered)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 825, in _read_query_result\n    result.read()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 1199, in read\n    first_packet = self.connection._read_packet()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 775, in _read_packet\n    packet.raise_for_error()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\protocol.py\", line 219, in raise_for_error\n    err.raise_mysql_exception(self._data)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\err.py\", line 150, in raise_mysql_exception\n    raise errorclass(errno, errval)\nsqlalchemy.exc.IntegrityError: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`patvs_test`.`test_case`, CONSTRAINT `fk_test_case_department_id_department` FOREIGN KEY (`department_id`) REFERENCES `department` (`id`) ON DELETE CASCADE)')\n[SQL: INSERT INTO test_case (department_id, group_id, title, preconditions, steps, expected_result, keywords, priority, status, case_type, workload_minutes, created_by, updated_by, deleted_at, deleted_by) VALUES (%(department_id)s, %(group_id)s, %(title)s, %(preconditions)s, %(steps)s, %(expected_result)s, %(keywords)s, %(priority)s, %(status)s, %(case_type)s, %(workload_minutes)s, %(created_by)s, %(updated_by)s, %(deleted_at)s, %(deleted_by)s)]\n[parameters: {'department_id': 13, 'group_id': None, 'title': '登录用例_e3883560', 'preconditions': '浏览器已打开', 'steps': '[{\"no\": 1, \"action\": \"\\\\u6253\\\\u5f00\\\\u767b\\\\u5f55\\\\u9875\\\\u9762\", \"keyword\": \"\\\\u6253\\\\u5f00\", \"note\": \"\\\\u786e\\\\u4fdd\\\\u9875\\\\u9762\\\\u52a0\\\\u8f7d\\\\ ... (632 characters truncated) ... \\u70b9\\\\u51fb\", \"note\": \"\\\\u70b9\\\\u51fb\\\\u767b\\\\u5f55\\\\u6309\\\\u94ae\\\\u63d0\\\\u4ea4\\\\u8868\\\\u5355\", \"expected\": \"\\\\u8df3\\\\u8f6c\\\\u5230\\\\u9996\\\\u9875\"}]', 'expected_result': '登录成功后进入首页', 'keywords': '[\"\\\\u767b\\\\u5f55\", \"\\\\u6b63\\\\u5411\"]', 'priority': 'P2', 'status': 'active', 'case_type': 'functional', 'workload_minutes': None, 'created_by': 1, 'updated_by': 1, 'deleted_at': None, 'deleted_by': None}]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)"}
{"ts": "2025-08-27T17:07:17", "level": "ERROR", "logger": "app", "msg": "UNHANDLED EXCEPTION", "request_id": "bcd4bb77e58349a28ac0383309be8d65", "exc": "Traceback (most recent call last):\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 951, in do_execute\n    cursor.execute(statement, parameters)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\cursors.py\", line 153, in execute\n    result = self._query(query)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\cursors.py\", line 322, in _query\n    conn.query(q)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 563, in query\n    self._affected_rows = self._read_query_result(unbuffered=unbuffered)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 825, in _read_query_result\n    result.read()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 1199, in read\n    first_packet = self.connection._read_packet()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 775, in _read_packet\n    packet.raise_for_error()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\protocol.py\", line 219, in raise_for_error\n    err.raise_mysql_exception(self._data)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\err.py\", line 150, in raise_mysql_exception\n    raise errorclass(errno, errval)\npymysql.err.IntegrityError: (1452, 'Cannot add or update a child row: a foreign key constraint fails (`patvs_test`.`test_case`, CONSTRAINT `fk_test_case_department_id_department` FOREIGN KEY (`department_id`) REFERENCES `department` (`id`) ON DELETE CASCADE)')\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\flask\\app.py\", line 917, in full_dispatch_request\n    rv = self.dispatch_request()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\flask\\app.py\", line 902, in dispatch_request\n    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]\n  File \"D:\\TestTrackingSystem\\controllers\\auth_helpers.py\", line 133, in wrapper\n    return fn(*args, **kwargs)\n  File \"D:\\TestTrackingSystem\\controllers\\test_case_controller.py\", line 50, in create_test_case\n    test_case = TestCaseService.create(\n  File \"D:\\TestTrackingSystem\\services\\test_case_service.py\", line 75, in create\n    test_case = TestCaseRepository.create(\n  File \"D:\\TestTrackingSystem\\repositories\\test_case_repository.py\", line 39, in create\n    db.session.commit()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\scoping.py\", line 599, in commit\n    return self._proxied.commit()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2032, in commit\n    trans.commit(_to_root=True)\n  File \"<string>\", line 2, in commit\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 137, in _go\n    ret_value = fn(self, *arg, **kw)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1313, in commit\n    self._prepare_impl()\n  File \"<string>\", line 2, in _prepare_impl\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 137, in _go\n    ret_value = fn(self, *arg, **kw)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1288, in _prepare_impl\n    self.session.flush()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4345, in flush\n    self._flush(objects)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4480, in _flush\n    with util.safe_reraise():\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\util\\langhelpers.py\", line 224, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4441, in _flush\n    flush_context.execute()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 466, in execute\n    rec.execute(self)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 1233, in _emit_insert_statements\n    result = connection.execute(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1419, in execute\n    return meth(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\sql\\elements.py\", line 526, in _execute_on_connection\n    return connection._execute_clauseelement(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1641, in _execute_clauseelement\n    ret = self._execute_context(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1846, in _execute_context\n    return self._exec_single_context(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1986, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2355, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 951, in do_execute\n    cursor.execute(statement, parameters)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\cursors.py\", line 153, in execute\n    result = self._query(query)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\cursors.py\", line 322, in _query\n    conn.query(q)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 563, in query\n    self._affected_rows = self._read_query_result(unbuffered=unbuffered)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 825, in _read_query_result\n    result.read()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 1199, in read\n    first_packet = self.connection._read_packet()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 775, in _read_packet\n    packet.raise_for_error()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\protocol.py\", line 219, in raise_for_error\n    err.raise_mysql_exception(self._data)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\err.py\", line 150, in raise_mysql_exception\n    raise errorclass(errno, errval)\nsqlalchemy.exc.IntegrityError: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`patvs_test`.`test_case`, CONSTRAINT `fk_test_case_department_id_department` FOREIGN KEY (`department_id`) REFERENCES `department` (`id`) ON DELETE CASCADE)')\n[SQL: INSERT INTO test_case (department_id, group_id, title, preconditions, steps, expected_result, keywords, priority, status, case_type, workload_minutes, created_by, updated_by, deleted_at, deleted_by) VALUES (%(department_id)s, %(group_id)s, %(title)s, %(preconditions)s, %(steps)s, %(expected_result)s, %(keywords)s, %(priority)s, %(status)s, %(case_type)s, %(workload_minutes)s, %(created_by)s, %(updated_by)s, %(deleted_at)s, %(deleted_by)s)]\n[parameters: {'department_id': 13, 'group_id': None, 'title': '登录用例_4b5910fe', 'preconditions': '浏览器已打开', 'steps': '[{\"no\": 1, \"action\": \"\\\\u6253\\\\u5f00\\\\u767b\\\\u5f55\\\\u9875\\\\u9762\", \"keyword\": \"\\\\u6253\\\\u5f00\", \"note\": \"\\\\u786e\\\\u4fdd\\\\u9875\\\\u9762\\\\u52a0\\\\u8f7d\\\\ ... (632 characters truncated) ... \\u70b9\\\\u51fb\", \"note\": \"\\\\u70b9\\\\u51fb\\\\u767b\\\\u5f55\\\\u6309\\\\u94ae\\\\u63d0\\\\u4ea4\\\\u8868\\\\u5355\", \"expected\": \"\\\\u8df3\\\\u8f6c\\\\u5230\\\\u9996\\\\u9875\"}]', 'expected_result': '登录成功后进入首页', 'keywords': '[\"\\\\u767b\\\\u5f55\", \"\\\\u6b63\\\\u5411\"]', 'priority': 'P2', 'status': 'active', 'case_type': 'functional', 'workload_minutes': None, 'created_by': 1, 'updated_by': 1, 'deleted_at': None, 'deleted_by': None}]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)"}
{"ts": "2025-08-27T17:52:34", "level": "ERROR", "logger": "app", "msg": "UNHANDLED EXCEPTION", "request_id": "b8940e7825864fa4aa7cdb97ed8b8c32", "exc": "Traceback (most recent call last):\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 951, in do_execute\n    cursor.execute(statement, parameters)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\cursors.py\", line 153, in execute\n    result = self._query(query)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\cursors.py\", line 322, in _query\n    conn.query(q)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 563, in query\n    self._affected_rows = self._read_query_result(unbuffered=unbuffered)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 825, in _read_query_result\n    result.read()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 1199, in read\n    first_packet = self.connection._read_packet()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 775, in _read_packet\n    packet.raise_for_error()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\protocol.py\", line 219, in raise_for_error\n    err.raise_mysql_exception(self._data)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\err.py\", line 150, in raise_mysql_exception\n    raise errorclass(errno, errval)\npymysql.err.IntegrityError: (1452, 'Cannot add or update a child row: a foreign key constraint fails (`patvs_test`.`test_case`, CONSTRAINT `fk_test_case_department_id_department` FOREIGN KEY (`department_id`) REFERENCES `department` (`id`) ON DELETE CASCADE)')\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\flask\\app.py\", line 917, in full_dispatch_request\n    rv = self.dispatch_request()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\flask\\app.py\", line 902, in dispatch_request\n    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]\n  File \"D:\\TestTrackingSystem\\controllers\\auth_helpers.py\", line 133, in wrapper\n    return fn(*args, **kwargs)\n  File \"D:\\TestTrackingSystem\\controllers\\test_case_controller.py\", line 52, in create_test_case\n    test_case = TestCaseService.create(\n  File \"D:\\TestTrackingSystem\\services\\test_case_service.py\", line 92, in create\n    test_case = TestCaseRepository.create(test_case)\n  File \"D:\\TestTrackingSystem\\repositories\\test_case_repository.py\", line 17, in create\n    db.session.commit()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\scoping.py\", line 599, in commit\n    return self._proxied.commit()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2032, in commit\n    trans.commit(_to_root=True)\n  File \"<string>\", line 2, in commit\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 137, in _go\n    ret_value = fn(self, *arg, **kw)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1313, in commit\n    self._prepare_impl()\n  File \"<string>\", line 2, in _prepare_impl\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 137, in _go\n    ret_value = fn(self, *arg, **kw)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1288, in _prepare_impl\n    self.session.flush()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4345, in flush\n    self._flush(objects)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4480, in _flush\n    with util.safe_reraise():\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\util\\langhelpers.py\", line 224, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4441, in _flush\n    flush_context.execute()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 466, in execute\n    rec.execute(self)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 1233, in _emit_insert_statements\n    result = connection.execute(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1419, in execute\n    return meth(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\sql\\elements.py\", line 526, in _execute_on_connection\n    return connection._execute_clauseelement(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1641, in _execute_clauseelement\n    ret = self._execute_context(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1846, in _execute_context\n    return self._exec_single_context(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1986, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2355, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 951, in do_execute\n    cursor.execute(statement, parameters)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\cursors.py\", line 153, in execute\n    result = self._query(query)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\cursors.py\", line 322, in _query\n    conn.query(q)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 563, in query\n    self._affected_rows = self._read_query_result(unbuffered=unbuffered)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 825, in _read_query_result\n    result.read()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 1199, in read\n    first_packet = self.connection._read_packet()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 775, in _read_packet\n    packet.raise_for_error()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\protocol.py\", line 219, in raise_for_error\n    err.raise_mysql_exception(self._data)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\err.py\", line 150, in raise_mysql_exception\n    raise errorclass(errno, errval)\nsqlalchemy.exc.IntegrityError: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`patvs_test`.`test_case`, CONSTRAINT `fk_test_case_department_id_department` FOREIGN KEY (`department_id`) REFERENCES `department` (`id`) ON DELETE CASCADE)')\n[SQL: INSERT INTO test_case (department_id, group_id, title, preconditions, steps, expected_result, keywords, priority, status, case_type, workload_minutes, created_by, updated_by, deleted_at, deleted_by) VALUES (%(department_id)s, %(group_id)s, %(title)s, %(preconditions)s, %(steps)s, %(expected_result)s, %(keywords)s, %(priority)s, %(status)s, %(case_type)s, %(workload_minutes)s, %(created_by)s, %(updated_by)s, %(deleted_at)s, %(deleted_by)s)]\n[parameters: {'department_id': 13, 'group_id': None, 'title': '登录用例_ef7435fd', 'preconditions': '浏览器已打开', 'steps': '[{\"no\": 1, \"action\": \"\\\\u6253\\\\u5f00\\\\u767b\\\\u5f55\\\\u9875\\\\u9762\", \"keyword\": \"\\\\u6253\\\\u5f00\", \"note\": \"\\\\u786e\\\\u4fdd\\\\u9875\\\\u9762\\\\u52a0\\\\u8f7d\\\\ ... (632 characters truncated) ... \\u70b9\\\\u51fb\", \"note\": \"\\\\u70b9\\\\u51fb\\\\u767b\\\\u5f55\\\\u6309\\\\u94ae\\\\u63d0\\\\u4ea4\\\\u8868\\\\u5355\", \"expected\": \"\\\\u8df3\\\\u8f6c\\\\u5230\\\\u9996\\\\u9875\"}]', 'expected_result': '登录成功后进入首页', 'keywords': '[\"\\\\u767b\\\\u5f55\", \"\\\\u6b63\\\\u5411\"]', 'priority': 'P2', 'status': 'active', 'case_type': 'functional', 'workload_minutes': None, 'created_by': 1, 'updated_by': 1, 'deleted_at': None, 'deleted_by': None}]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)"}
{"ts": "2025-08-27T17:55:23", "level": "ERROR", "logger": "app", "msg": "UNHANDLED EXCEPTION", "request_id": "0ed92b17779a4ea28b7cb3604f2fa34a", "exc": "Traceback (most recent call last):\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 951, in do_execute\n    cursor.execute(statement, parameters)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\cursors.py\", line 153, in execute\n    result = self._query(query)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\cursors.py\", line 322, in _query\n    conn.query(q)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 563, in query\n    self._affected_rows = self._read_query_result(unbuffered=unbuffered)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 825, in _read_query_result\n    result.read()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 1199, in read\n    first_packet = self.connection._read_packet()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 775, in _read_packet\n    packet.raise_for_error()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\protocol.py\", line 219, in raise_for_error\n    err.raise_mysql_exception(self._data)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\err.py\", line 150, in raise_mysql_exception\n    raise errorclass(errno, errval)\npymysql.err.IntegrityError: (1452, 'Cannot add or update a child row: a foreign key constraint fails (`patvs_test`.`test_case`, CONSTRAINT `fk_test_case_department_id_department` FOREIGN KEY (`department_id`) REFERENCES `department` (`id`) ON DELETE CASCADE)')\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\flask\\app.py\", line 917, in full_dispatch_request\n    rv = self.dispatch_request()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\flask\\app.py\", line 902, in dispatch_request\n    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]\n  File \"D:\\TestTrackingSystem\\controllers\\auth_helpers.py\", line 133, in wrapper\n    return fn(*args, **kwargs)\n  File \"D:\\TestTrackingSystem\\controllers\\test_case_controller.py\", line 52, in create_test_case\n    test_case = TestCaseService.create(\n  File \"D:\\TestTrackingSystem\\services\\test_case_service.py\", line 92, in create\n    test_case = TestCaseRepository.create(test_case)\n  File \"D:\\TestTrackingSystem\\repositories\\test_case_repository.py\", line 17, in create\n    db.session.commit()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\scoping.py\", line 599, in commit\n    return self._proxied.commit()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2032, in commit\n    trans.commit(_to_root=True)\n  File \"<string>\", line 2, in commit\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 137, in _go\n    ret_value = fn(self, *arg, **kw)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1313, in commit\n    self._prepare_impl()\n  File \"<string>\", line 2, in _prepare_impl\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 137, in _go\n    ret_value = fn(self, *arg, **kw)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1288, in _prepare_impl\n    self.session.flush()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4345, in flush\n    self._flush(objects)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4480, in _flush\n    with util.safe_reraise():\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\util\\langhelpers.py\", line 224, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4441, in _flush\n    flush_context.execute()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 466, in execute\n    rec.execute(self)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 1233, in _emit_insert_statements\n    result = connection.execute(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1419, in execute\n    return meth(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\sql\\elements.py\", line 526, in _execute_on_connection\n    return connection._execute_clauseelement(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1641, in _execute_clauseelement\n    ret = self._execute_context(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1846, in _execute_context\n    return self._exec_single_context(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1986, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2355, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 951, in do_execute\n    cursor.execute(statement, parameters)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\cursors.py\", line 153, in execute\n    result = self._query(query)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\cursors.py\", line 322, in _query\n    conn.query(q)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 563, in query\n    self._affected_rows = self._read_query_result(unbuffered=unbuffered)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 825, in _read_query_result\n    result.read()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 1199, in read\n    first_packet = self.connection._read_packet()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 775, in _read_packet\n    packet.raise_for_error()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\protocol.py\", line 219, in raise_for_error\n    err.raise_mysql_exception(self._data)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\err.py\", line 150, in raise_mysql_exception\n    raise errorclass(errno, errval)\nsqlalchemy.exc.IntegrityError: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`patvs_test`.`test_case`, CONSTRAINT `fk_test_case_department_id_department` FOREIGN KEY (`department_id`) REFERENCES `department` (`id`) ON DELETE CASCADE)')\n[SQL: INSERT INTO test_case (department_id, group_id, title, preconditions, steps, expected_result, keywords, priority, status, case_type, workload_minutes, created_by, updated_by, deleted_at, deleted_by) VALUES (%(department_id)s, %(group_id)s, %(title)s, %(preconditions)s, %(steps)s, %(expected_result)s, %(keywords)s, %(priority)s, %(status)s, %(case_type)s, %(workload_minutes)s, %(created_by)s, %(updated_by)s, %(deleted_at)s, %(deleted_by)s)]\n[parameters: {'department_id': 13, 'group_id': None, 'title': '登录用例_6c63f93c', 'preconditions': '浏览器已打开', 'steps': '[{\"no\": 1, \"action\": \"\\\\u6253\\\\u5f00\\\\u767b\\\\u5f55\\\\u9875\\\\u9762\", \"keyword\": \"\\\\u6253\\\\u5f00\", \"note\": \"\\\\u786e\\\\u4fdd\\\\u9875\\\\u9762\\\\u52a0\\\\u8f7d\\\\ ... (632 characters truncated) ... \\u70b9\\\\u51fb\", \"note\": \"\\\\u70b9\\\\u51fb\\\\u767b\\\\u5f55\\\\u6309\\\\u94ae\\\\u63d0\\\\u4ea4\\\\u8868\\\\u5355\", \"expected\": \"\\\\u8df3\\\\u8f6c\\\\u5230\\\\u9996\\\\u9875\"}]', 'expected_result': '登录成功后进入首页', 'keywords': '[\"\\\\u767b\\\\u5f55\", \"\\\\u6b63\\\\u5411\"]', 'priority': 'P2', 'status': 'active', 'case_type': 'functional', 'workload_minutes': None, 'created_by': 1, 'updated_by': 1, 'deleted_at': None, 'deleted_by': None}]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)"}
{"ts": "2025-08-27T18:02:09", "level": "ERROR", "logger": "app", "msg": "UNHANDLED EXCEPTION", "request_id": "3fbbf29095924c7cbcce5409de69ae9b", "exc": "Traceback (most recent call last):\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\sql\\base.py\", line 2215, in _entity_namespace_key\n    return getattr(ns, key)  # type: ignore\nAttributeError: type object 'Department' has no attribute 'is_deleted'\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\flask\\app.py\", line 917, in full_dispatch_request\n    rv = self.dispatch_request()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\flask\\app.py\", line 902, in dispatch_request\n    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]\n  File \"D:\\TestTrackingSystem\\controllers\\auth_helpers.py\", line 133, in wrapper\n    return fn(*args, **kwargs)\n  File \"D:\\TestTrackingSystem\\controllers\\test_case_controller.py\", line 52, in create_test_case\n    test_case = TestCaseService.create(\n  File \"D:\\TestTrackingSystem\\services\\test_case_service.py\", line 76, in create\n    department = Department.query.filter_by(id=department_id, is_deleted=False).first()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\query.py\", line 1991, in filter_by\n    clauses = [\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\query.py\", line 1992, in <listcomp>\n    _entity_namespace_key(from_entity, key) == value\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\sql\\base.py\", line 2217, in _entity_namespace_key\n    raise exc.InvalidRequestError(\nsqlalchemy.exc.InvalidRequestError: Entity namespace for \"department\" has no property \"is_deleted\""}
{"ts": "2025-08-27T18:03:29", "level": "ERROR", "logger": "app", "msg": "UNHANDLED EXCEPTION", "request_id": "66cb6e0002124bf7a99388a48f00b7f5", "exc": "Traceback (most recent call last):\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\sql\\base.py\", line 2215, in _entity_namespace_key\n    return getattr(ns, key)  # type: ignore\nAttributeError: type object 'Department' has no attribute 'is_deleted'\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\flask\\app.py\", line 917, in full_dispatch_request\n    rv = self.dispatch_request()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\flask\\app.py\", line 902, in dispatch_request\n    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]\n  File \"D:\\TestTrackingSystem\\controllers\\auth_helpers.py\", line 133, in wrapper\n    return fn(*args, **kwargs)\n  File \"D:\\TestTrackingSystem\\controllers\\test_case_controller.py\", line 52, in create_test_case\n    test_case = TestCaseService.create(\n  File \"D:\\TestTrackingSystem\\services\\test_case_service.py\", line 76, in create\n    department = Department.query.filter_by(id=department_id).first()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\query.py\", line 1991, in filter_by\n    clauses = [\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\query.py\", line 1992, in <listcomp>\n    _entity_namespace_key(from_entity, key) == value\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\sql\\base.py\", line 2217, in _entity_namespace_key\n    raise exc.InvalidRequestError(\nsqlalchemy.exc.InvalidRequestError: Entity namespace for \"department\" has no property \"is_deleted\""}
{"ts": "2025-08-28T10:59:39", "level": "ERROR", "logger": "app", "msg": "UNHANDLED EXCEPTION", "request_id": "92d4c3bac8024c14b32c238880c13361", "exc": "Traceback (most recent call last):\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\flask\\app.py\", line 917, in full_dispatch_request\n    rv = self.dispatch_request()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\flask\\app.py\", line 902, in dispatch_request\n    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]\n  File \"D:\\TestTrackingSystem\\controllers\\auth_helpers.py\", line 133, in wrapper\n    return fn(*args, **kwargs)\n  File \"D:\\TestTrackingSystem\\controllers\\test_case_controller.py\", line 115, in get_test_case\n    \"display_name\": test_case.creator.display_name\nAttributeError: 'User' object has no attribute 'display_name'"}
{"ts": "2025-08-28T10:59:40", "level": "ERROR", "logger": "app", "msg": "UNHANDLED EXCEPTION", "request_id": "2415ded1bb97427f9d665604acf05089", "exc": "Traceback (most recent call last):\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\flask\\app.py\", line 917, in full_dispatch_request\n    rv = self.dispatch_request()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\flask\\app.py\", line 902, in dispatch_request\n    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]\n  File \"D:\\TestTrackingSystem\\controllers\\auth_helpers.py\", line 133, in wrapper\n    return fn(*args, **kwargs)\n  File \"D:\\TestTrackingSystem\\controllers\\test_case_controller.py\", line 115, in get_test_case\n    \"display_name\": test_case.creator.display_name\nAttributeError: 'User' object has no attribute 'display_name'"}
{"ts": "2025-08-28T10:59:41", "level": "ERROR", "logger": "werkzeug", "msg": "Error on request:\nTraceback (most recent call last):\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\werkzeug\\serving.py\", line 370, in run_wsgi\n    execute(self.server.app)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\werkzeug\\serving.py\", line 334, in execute\n    write(data)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\werkzeug\\serving.py\", line 271, in write\n    self.send_response(code, msg)\n  File \"C:\\Python\\Python310\\lib\\http\\server.py\", line 499, in send_response\n    self.send_response_only(code, message)\n  File \"C:\\Python\\Python310\\lib\\http\\server.py\", line 514, in send_response_only\n    (self.protocol_version, code, message)).encode(\nUnicodeEncodeError: 'latin-1' codec can't encode characters in position 11-16: ordinal not in range(256)", "request_id": "-"}
{"ts": "2025-08-28T10:59:55", "level": "ERROR", "logger": "app", "msg": "UNHANDLED EXCEPTION", "request_id": "c119420756c64224af4fffcf9f095217", "exc": "Traceback (most recent call last):\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\flask\\app.py\", line 917, in full_dispatch_request\n    rv = self.dispatch_request()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\flask\\app.py\", line 902, in dispatch_request\n    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]\n  File \"D:\\TestTrackingSystem\\controllers\\auth_helpers.py\", line 133, in wrapper\n    return fn(*args, **kwargs)\n  File \"D:\\TestTrackingSystem\\controllers\\test_case_controller.py\", line 258, in list_test_cases\n    \"display_name\": tc.creator.display_name\nAttributeError: 'User' object has no attribute 'display_name'"}
{"ts": "2025-08-28T11:01:01", "level": "ERROR", "logger": "app", "msg": "UNHANDLED EXCEPTION", "request_id": "85632446e0e04a74836e47e91dbe66e8", "exc": "Traceback (most recent call last):\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\flask\\app.py\", line 917, in full_dispatch_request\n    rv = self.dispatch_request()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\flask\\app.py\", line 902, in dispatch_request\n    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]\n  File \"D:\\TestTrackingSystem\\controllers\\auth_helpers.py\", line 133, in wrapper\n    return fn(*args, **kwargs)\n  File \"D:\\TestTrackingSystem\\controllers\\test_case_controller.py\", line 115, in get_test_case\n    \"display_name\": test_case.creator.display_name\nAttributeError: 'User' object has no attribute 'display_name'"}
{"ts": "2025-08-28T14:55:10", "level": "ERROR", "logger": "app", "msg": "UNHANDLED EXCEPTION", "request_id": "e69a388680f54b559c9a613e740ce11a", "exc": "Traceback (most recent call last):\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\flask\\app.py\", line 917, in full_dispatch_request\n    rv = self.dispatch_request()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\flask\\app.py\", line 902, in dispatch_request\n    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]\n  File \"D:\\TestTrackingSystem\\controllers\\auth_helpers.py\", line 133, in wrapper\n    return fn(*args, **kwargs)\n  File \"D:\\TestTrackingSystem\\controllers\\test_case_controller.py\", line 256, in list_test_cases\n    \"display_name\": tc.creator.display_name\nAttributeError: 'User' object has no attribute 'display_name'"}
{"ts": "2025-09-10T11:22:44", "level": "ERROR", "logger": "werkzeug", "msg": "Error on request:\nTraceback (most recent call last):\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\werkzeug\\serving.py\", line 370, in run_wsgi\n    execute(self.server.app)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\werkzeug\\serving.py\", line 334, in execute\n    write(data)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\werkzeug\\serving.py\", line 271, in write\n    self.send_response(code, msg)\n  File \"C:\\Python\\Python310\\lib\\http\\server.py\", line 499, in send_response\n    self.send_response_only(code, message)\n  File \"C:\\Python\\Python310\\lib\\http\\server.py\", line 514, in send_response_only\n    (self.protocol_version, code, message)).encode(\nUnicodeEncodeError: 'latin-1' codec can't encode characters in position 11-26: ordinal not in range(256)", "request_id": "-"}
{"ts": "2025-09-10T11:22:55", "level": "ERROR", "logger": "app", "msg": "UNHANDLED EXCEPTION", "request_id": "dfbbf6ac92f24ab2a117edc482f22f32", "exc": "Traceback (most recent call last):\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 951, in do_execute\n    cursor.execute(statement, parameters)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\cursors.py\", line 153, in execute\n    result = self._query(query)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\cursors.py\", line 322, in _query\n    conn.query(q)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 563, in query\n    self._affected_rows = self._read_query_result(unbuffered=unbuffered)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 825, in _read_query_result\n    result.read()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 1199, in read\n    first_packet = self.connection._read_packet()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 775, in _read_packet\n    packet.raise_for_error()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\protocol.py\", line 219, in raise_for_error\n    err.raise_mysql_exception(self._data)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\err.py\", line 150, in raise_mysql_exception\n    raise errorclass(errno, errval)\npymysql.err.ProgrammingError: (1064, \"You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'NULLS FIRST, case_group.order_no, case_group.id' at line 3\")\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\flask\\app.py\", line 917, in full_dispatch_request\n    rv = self.dispatch_request()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\flask\\app.py\", line 902, in dispatch_request\n    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]\n  File \"D:\\TestTrackingSystem\\controllers\\auth_helpers.py\", line 133, in wrapper\n    return fn(*args, **kwargs)\n  File \"D:\\TestTrackingSystem\\controllers\\case_group_controller.py\", line 118, in get_case_group_tree\n    tree = CaseGroupService.tree(department_id, user, with_case_count=with_case_count)\n  File \"D:\\TestTrackingSystem\\services\\case_group_service.py\", line 250, in tree\n    groups = CaseGroupRepository.list_by_department(department_id)\n  File \"D:\\TestTrackingSystem\\repositories\\case_group_repository.py\", line 22, in list_by_department\n    return q.order_by(CaseGroup.parent_id.nullsfirst(), CaseGroup.order_no, CaseGroup.id).all()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\query.py\", line 2704, in all\n    return self._iter().all()  # type: ignore\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\query.py\", line 2857, in _iter\n    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2365, in execute\n    return self._execute_internal(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2251, in _execute_internal\n    result: Result[Any] = compile_state_cls.orm_execute_statement(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\context.py\", line 306, in orm_execute_statement\n    result = conn.execute(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1419, in execute\n    return meth(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\sql\\elements.py\", line 526, in _execute_on_connection\n    return connection._execute_clauseelement(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1641, in _execute_clauseelement\n    ret = self._execute_context(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1846, in _execute_context\n    return self._exec_single_context(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1986, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2355, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 951, in do_execute\n    cursor.execute(statement, parameters)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\cursors.py\", line 153, in execute\n    result = self._query(query)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\cursors.py\", line 322, in _query\n    conn.query(q)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 563, in query\n    self._affected_rows = self._read_query_result(unbuffered=unbuffered)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 825, in _read_query_result\n    result.read()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 1199, in read\n    first_packet = self.connection._read_packet()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 775, in _read_packet\n    packet.raise_for_error()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\protocol.py\", line 219, in raise_for_error\n    err.raise_mysql_exception(self._data)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\err.py\", line 150, in raise_mysql_exception\n    raise errorclass(errno, errval)\nsqlalchemy.exc.ProgrammingError: (pymysql.err.ProgrammingError) (1064, \"You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'NULLS FIRST, case_group.order_no, case_group.id' at line 3\")\n[SQL: SELECT case_group.id AS case_group_id, case_group.department_id AS case_group_department_id, case_group.parent_id AS case_group_parent_id, case_group.name AS case_group_name, case_group.path AS case_group_path, case_group.order_no AS case_group_order_no, case_group.created_by AS case_group_created_by, case_group.updated_by AS case_group_updated_by, case_group.created_at AS case_group_created_at, case_group.updated_at AS case_group_updated_at, case_group.is_deleted AS case_group_is_deleted, case_group.deleted_at AS case_group_deleted_at, case_group.deleted_by AS case_group_deleted_by \nFROM case_group \nWHERE case_group.department_id = %(department_id_1)s AND case_group.is_deleted IS false ORDER BY case_group.parent_id NULLS FIRST, case_group.order_no, case_group.id]\n[parameters: {'department_id_1': 13}]\n(Background on this error at: https://sqlalche.me/e/20/f405)"}
{"ts": "2025-09-10T11:22:58", "level": "ERROR", "logger": "app", "msg": "UNHANDLED EXCEPTION", "request_id": "77feea0e13924e73bae4a0f2dab3cb3f", "exc": "Traceback (most recent call last):\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\flask\\app.py\", line 917, in full_dispatch_request\n    rv = self.dispatch_request()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\flask\\app.py\", line 902, in dispatch_request\n    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]\n  File \"D:\\TestTrackingSystem\\controllers\\auth_helpers.py\", line 133, in wrapper\n    return fn(*args, **kwargs)\n  File \"D:\\TestTrackingSystem\\controllers\\case_group_controller.py\", line 91, in delete_case_group\n    deleted_case_count = CaseGroupService.delete(group_id, user)\n  File \"D:\\TestTrackingSystem\\services\\case_group_service.py\", line 123, in delete\n    with db.session.begin():\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\scoping.py\", line 445, in begin\n    return self._proxied.begin(nested=nested)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1943, in begin\n    raise sa_exc.InvalidRequestError(\nsqlalchemy.exc.InvalidRequestError: A transaction is already begun on this Session."}
{"ts": "2025-09-10T11:23:02", "level": "ERROR", "logger": "app", "msg": "UNHANDLED EXCEPTION", "request_id": "0e272077fa86473f9e4f4a994d100191", "exc": "Traceback (most recent call last):\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\flask\\app.py\", line 917, in full_dispatch_request\n    rv = self.dispatch_request()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\flask\\app.py\", line 902, in dispatch_request\n    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]\n  File \"D:\\TestTrackingSystem\\controllers\\auth_helpers.py\", line 133, in wrapper\n    return fn(*args, **kwargs)\n  File \"D:\\TestTrackingSystem\\controllers\\case_group_controller.py\", line 104, in copy_case_group\n    result = CaseGroupService.copy(\n  File \"D:\\TestTrackingSystem\\services\\case_group_service.py\", line 176, in copy\n    with db.session.begin():\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\scoping.py\", line 445, in begin\n    return self._proxied.begin(nested=nested)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1943, in begin\n    raise sa_exc.InvalidRequestError(\nsqlalchemy.exc.InvalidRequestError: A transaction is already begun on this Session."}
{"ts": "2025-09-10T11:23:03", "level": "ERROR", "logger": "app", "msg": "UNHANDLED EXCEPTION", "request_id": "52c1c5c5b9954003ad6c4c111c166627", "exc": "Traceback (most recent call last):\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\flask\\app.py\", line 917, in full_dispatch_request\n    rv = self.dispatch_request()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\flask\\app.py\", line 902, in dispatch_request\n    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]\n  File \"D:\\TestTrackingSystem\\controllers\\auth_helpers.py\", line 133, in wrapper\n    return fn(*args, **kwargs)\n  File \"D:\\TestTrackingSystem\\controllers\\case_group_controller.py\", line 104, in copy_case_group\n    result = CaseGroupService.copy(\n  File \"D:\\TestTrackingSystem\\services\\case_group_service.py\", line 176, in copy\n    with db.session.begin():\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\scoping.py\", line 445, in begin\n    return self._proxied.begin(nested=nested)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1943, in begin\n    raise sa_exc.InvalidRequestError(\nsqlalchemy.exc.InvalidRequestError: A transaction is already begun on this Session."}
{"ts": "2025-09-10T12:03:07", "level": "ERROR", "logger": "werkzeug", "msg": "10.201.0.190 - - [10/Sep/2025 12:03:07] code 400, message Bad request version (\"þ¢ÿ¡\\x8b\\x00n\\x13\\x02\\x13\\x01\\x13\\x03À,À+Ì©À0Ì¨À/\\x00\\x9fÌª\\x00£\\x00\\x9e\\x00¢À$À(À#À'\\x00k\\x00j\\x00g\\x00@À.À2À-À1À&À*À%À)À\")", "request_id": "-"}
{"ts": "2025-09-10T12:03:07", "level": "ERROR", "logger": "werkzeug", "msg": "10.201.0.190 - - [10/Sep/2025 12:03:07] code 400, message Bad request version (\"\\x00n\\x13\\x02\\x13\\x01\\x13\\x03À,À+Ì©À0Ì¨À/\\x00\\x9fÌª\\x00£\\x00\\x9e\\x00¢À$À(À#À'\\x00k\\x00j\\x00g\\x00@À.À2À-À1À&À*À%À)À\")", "request_id": "-"}
{"ts": "2025-09-10T16:01:13", "level": "ERROR", "logger": "app", "msg": "UNHANDLED EXCEPTION", "request_id": "011a14b6e2d5418eb9fea3905fe530cb", "exc": "Traceback (most recent call last):\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 951, in do_execute\n    cursor.execute(statement, parameters)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\cursors.py\", line 153, in execute\n    result = self._query(query)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\cursors.py\", line 322, in _query\n    conn.query(q)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 563, in query\n    self._affected_rows = self._read_query_result(unbuffered=unbuffered)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 825, in _read_query_result\n    result.read()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 1199, in read\n    first_packet = self.connection._read_packet()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 775, in _read_packet\n    packet.raise_for_error()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\protocol.py\", line 219, in raise_for_error\n    err.raise_mysql_exception(self._data)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\err.py\", line 150, in raise_mysql_exception\n    raise errorclass(errno, errval)\npymysql.err.ProgrammingError: (1064, \"You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'NULLS FIRST, case_group.order_no, case_group.id' at line 3\")\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\flask\\app.py\", line 917, in full_dispatch_request\n    rv = self.dispatch_request()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\flask\\app.py\", line 902, in dispatch_request\n    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]\n  File \"D:\\TestTrackingSystem\\controllers\\auth_helpers.py\", line 133, in wrapper\n    return fn(*args, **kwargs)\n  File \"D:\\TestTrackingSystem\\controllers\\case_group_controller.py\", line 116, in get_case_group_tree\n    tree = CaseGroupService.tree(department_id, user, with_case_count=with_case_count)\n  File \"D:\\TestTrackingSystem\\services\\case_group_service.py\", line 260, in tree\n    groups = CaseGroupRepository.list_by_department(department_id)\n  File \"D:\\TestTrackingSystem\\repositories\\case_group_repository.py\", line 26, in list_by_department\n    return q.order_by(CaseGroup.parent_id.nullsfirst(), CaseGroup.order_no, CaseGroup.id).all()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\query.py\", line 2704, in all\n    return self._iter().all()  # type: ignore\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\query.py\", line 2857, in _iter\n    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2365, in execute\n    return self._execute_internal(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2251, in _execute_internal\n    result: Result[Any] = compile_state_cls.orm_execute_statement(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\context.py\", line 306, in orm_execute_statement\n    result = conn.execute(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1419, in execute\n    return meth(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\sql\\elements.py\", line 526, in _execute_on_connection\n    return connection._execute_clauseelement(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1641, in _execute_clauseelement\n    ret = self._execute_context(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1846, in _execute_context\n    return self._exec_single_context(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1986, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2355, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 951, in do_execute\n    cursor.execute(statement, parameters)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\cursors.py\", line 153, in execute\n    result = self._query(query)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\cursors.py\", line 322, in _query\n    conn.query(q)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 563, in query\n    self._affected_rows = self._read_query_result(unbuffered=unbuffered)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 825, in _read_query_result\n    result.read()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 1199, in read\n    first_packet = self.connection._read_packet()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\connections.py\", line 775, in _read_packet\n    packet.raise_for_error()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\protocol.py\", line 219, in raise_for_error\n    err.raise_mysql_exception(self._data)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\pymysql\\err.py\", line 150, in raise_mysql_exception\n    raise errorclass(errno, errval)\nsqlalchemy.exc.ProgrammingError: (pymysql.err.ProgrammingError) (1064, \"You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'NULLS FIRST, case_group.order_no, case_group.id' at line 3\")\n[SQL: SELECT case_group.id AS case_group_id, case_group.department_id AS case_group_department_id, case_group.parent_id AS case_group_parent_id, case_group.name AS case_group_name, case_group.path AS case_group_path, case_group.order_no AS case_group_order_no, case_group.created_by AS case_group_created_by, case_group.updated_by AS case_group_updated_by, case_group.created_at AS case_group_created_at, case_group.updated_at AS case_group_updated_at, case_group.is_deleted AS case_group_is_deleted, case_group.deleted_at AS case_group_deleted_at, case_group.deleted_by AS case_group_deleted_by \nFROM case_group \nWHERE case_group.department_id = %(department_id_1)s AND case_group.is_deleted IS false ORDER BY case_group.parent_id NULLS FIRST, case_group.order_no, case_group.id]\n[parameters: {'department_id_1': 13}]\n(Background on this error at: https://sqlalche.me/e/20/f405)"}
{"ts": "2025-09-10T16:13:34", "level": "ERROR", "logger": "app", "msg": "UNHANDLED EXCEPTION", "request_id": "648613b17ebb4c319204ca2d4b1cad85", "exc": "Traceback (most recent call last):\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\flask\\app.py\", line 917, in full_dispatch_request\n    rv = self.dispatch_request()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\flask\\app.py\", line 902, in dispatch_request\n    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]\n  File \"D:\\TestTrackingSystem\\controllers\\auth_helpers.py\", line 133, in wrapper\n    return fn(*args, **kwargs)\n  File \"D:\\TestTrackingSystem\\controllers\\case_group_controller.py\", line 89, in delete_case_group\n    deleted_case_count = CaseGroupService.delete(group_id, user)\n  File \"D:\\TestTrackingSystem\\services\\case_group_service.py\", line 133, in delete\n    with db.session.begin():\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\scoping.py\", line 445, in begin\n    return self._proxied.begin(nested=nested)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1943, in begin\n    raise sa_exc.InvalidRequestError(\nsqlalchemy.exc.InvalidRequestError: A transaction is already begun on this Session."}
{"ts": "2025-09-10T16:19:15", "level": "ERROR", "logger": "app", "msg": "UNHANDLED EXCEPTION", "request_id": "01876cd8a900448f89ff1d2d56c14386", "exc": "Traceback (most recent call last):\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\flask\\app.py\", line 917, in full_dispatch_request\n    rv = self.dispatch_request()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\flask\\app.py\", line 902, in dispatch_request\n    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]\n  File \"D:\\TestTrackingSystem\\controllers\\auth_helpers.py\", line 133, in wrapper\n    return fn(*args, **kwargs)\n  File \"D:\\TestTrackingSystem\\controllers\\case_group_controller.py\", line 89, in delete_case_group\n    deleted_case_count = CaseGroupService.delete(group_id, user)\n  File \"D:\\TestTrackingSystem\\services\\case_group_service.py\", line 142, in delete\n    CaseGroupRepository.delete_groups_soft(group_ids)\n  File \"D:\\TestTrackingSystem\\repositories\\case_group_repository.py\", line 70, in delete_groups_soft\n    g.delete()  # SoftDeleteMixin\nAttributeError: 'CaseGroup' object has no attribute 'delete'"}
{"ts": "2025-09-10T16:19:33", "level": "ERROR", "logger": "app", "msg": "UNHANDLED EXCEPTION", "request_id": "b47bc8b2b275442684d9c072edebc232", "exc": "Traceback (most recent call last):\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\flask\\app.py\", line 917, in full_dispatch_request\n    rv = self.dispatch_request()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\flask\\app.py\", line 902, in dispatch_request\n    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]\n  File \"D:\\TestTrackingSystem\\controllers\\auth_helpers.py\", line 133, in wrapper\n    return fn(*args, **kwargs)\n  File \"D:\\TestTrackingSystem\\controllers\\case_group_controller.py\", line 89, in delete_case_group\n    deleted_case_count = CaseGroupService.delete(group_id, user)\n  File \"D:\\TestTrackingSystem\\services\\case_group_service.py\", line 142, in delete\n    CaseGroupRepository.delete_groups_soft(group_ids)\n  File \"D:\\TestTrackingSystem\\repositories\\case_group_repository.py\", line 70, in delete_groups_soft\n    g.delete()  # SoftDeleteMixin\nAttributeError: 'CaseGroup' object has no attribute 'delete'"}
{"ts": "2025-09-10T17:12:55", "level": "ERROR", "logger": "app", "msg": "UNHANDLED EXCEPTION", "request_id": "ceda66368b184b53a3d0c0c24c26b6a9", "exc": "Traceback (most recent call last):\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\flask\\app.py\", line 917, in full_dispatch_request\n    rv = self.dispatch_request()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\flask\\app.py\", line 902, in dispatch_request\n    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]\n  File \"D:\\TestTrackingSystem\\controllers\\auth_helpers.py\", line 133, in wrapper\n    return fn(*args, **kwargs)\n  File \"D:\\TestTrackingSystem\\controllers\\case_group_controller.py\", line 102, in copy_case_group\n    result = CaseGroupService.copy(\n  File \"D:\\TestTrackingSystem\\services\\case_group_service.py\", line 189, in copy\n    with db.session.begin():\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\scoping.py\", line 445, in begin\n    return self._proxied.begin(nested=nested)\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1943, in begin\n    raise sa_exc.InvalidRequestError(\nsqlalchemy.exc.InvalidRequestError: A transaction is already begun on this Session."}
{"ts": "2025-09-10T17:27:25", "level": "ERROR", "logger": "services.case_group_service", "msg": "复制异常: g.id=139, g.name=CopyChild1_FX06ef9e, old_parent_id=138, 已映射=[138]", "request_id": "35857959f24645499c977b244a694bb9"}
{"ts": "2025-09-10T17:38:16", "level": "ERROR", "logger": "app", "msg": "UNHANDLED EXCEPTION", "request_id": "eb3ab71d85b54a2d8e6017e2850ff8a9", "exc": "Traceback (most recent call last):\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\flask\\app.py\", line 917, in full_dispatch_request\n    rv = self.dispatch_request()\n  File \"D:\\TestTrackingSystem\\.venv\\lib\\site-packages\\flask\\app.py\", line 902, in dispatch_request\n    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]\n  File \"D:\\TestTrackingSystem\\controllers\\auth_helpers.py\", line 133, in wrapper\n    return fn(*args, **kwargs)\n  File \"D:\\TestTrackingSystem\\controllers\\case_group_controller.py\", line 102, in copy_case_group\n    result = CaseGroupService.copy(\n  File \"D:\\TestTrackingSystem\\services\\case_group_service.py\", line 192, in copy\n    old_id_to_new[int(source_group.id)] = int(new_root.id)\nTypeError: int() argument must be a string, a bytes-like object or a real number, not 'NoneType'"}
